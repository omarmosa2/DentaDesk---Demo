import{j as e}from"./ui-cacc1eea.js";import{r}from"./vendor-696af5bd.js";import{b as s}from"./qr-d6f50769.js";import{aj as a,ak as t,D as o,f as l,g as d,h as n,al as i,am as c,a8 as m,an as x,a9 as u,L as h,S as g,m as b,n as p,o as f,p as w,I as y,A as j,a0 as v,w as k,ao as N,ap as S,a3 as C,aq as R,F as A,a6 as P,Z as _,ar as E,as as I,C as Q,l as F,a4 as B,a5 as q,B as L,M as D,s as M,at as T,ag as z,ah as $,j as K,k as O,au as U,Q as V,e as W,X as G,d as H,r as X,$ as Z,av as Y,aw as J,y as ee,z as re,E as se,G as ae,H as te,N as oe,P as le,O as de,ax as ne}from"./index-3a8dc84c.js";import{c as ie}from"./utils-ec524415.js";import{U as ce}from"./unlock-51cfe0e8.js";import{P as me}from"./pen-square-6c634feb.js";import{U as xe}from"./users-5a609aa2.js";import{Z as ue}from"./zap-6d3cd988.js";import{F as he}from"./file-text-861b9f90.js";import{B as ge}from"./bar-chart-3-2a89747c.js";import{S as be}from"./settings-39dd9f65.js";import{P as pe}from"./plus-1eab3b5b.js";import{E as fe}from"./exportService-1536567b.js";import{S as we}from"./switch-3ea40783.js";import{D as ye,U as je,T as ve}from"./upload-4df8a268.js";import{P as ke}from"./phone-a8e6eab2.js";import{H as Ne}from"./hard-drive-04d0cddb.js";import{I as Se}from"./image-d8fa81df.js";import{M as Ce}from"./mail-8c3a07ed.js";import"./pdf-991f41f6.js";import"./charts-b4389b44.js";import"./excel-37615a09.js";
/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=a("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]),Ae=a("FlaskConical",[["path",{d:"M10 2v7.527a2 2 0 0 1-.211.896L4.72 20.55a1 1 0 0 0 .9 1.45h12.76a1 1 0 0 0 .9-1.45l-5.069-10.127A2 2 0 0 1 14 9.527V2",key:"pzvekw"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M7 16h10",key:"wp8him"}]]),Pe=a("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),_e=a("Keyboard",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",ry:"2",key:"15u882"}],["path",{d:"M6 8h.001",key:"1ej0i3"}],["path",{d:"M10 8h.001",key:"1x2st2"}],["path",{d:"M14 8h.001",key:"1vkmyp"}],["path",{d:"M18 8h.001",key:"kfsenl"}],["path",{d:"M8 12h.001",key:"1sjpby"}],["path",{d:"M12 12h.001",key:"al75ts"}],["path",{d:"M16 12h.001",key:"931bgk"}],["path",{d:"M7 16h10",key:"wp8him"}]]),Ee=a("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),Ie=ie()(t((e,r)=>({backups:[],isLoading:!1,error:null,isCreatingBackup:!1,isRestoringBackup:!1,lastBackupDate:null,autoBackupEnabled:!0,backupFrequency:"daily",loadBackups:async()=>{e({isLoading:!0,error:null});try{const[r,s]=await Promise.all([window.electronAPI.backup.list(),window.electronAPI.settings.get()]),a=Array.isArray(r)&&r.length>0&&"string"==typeof r[0]?r.map(e=>({name:e,path:e,size:0,created_at:(new Date).toISOString(),version:"1.0.0"})):r;e({backups:a,isLoading:!1,lastBackupDate:a.length>0?a[0].created_at:null,autoBackupEnabled:"disabled"!==s?.backup_frequency&&void 0!==s?.backup_frequency,backupFrequency:"disabled"===s?.backup_frequency||"hourly"===s?.backup_frequency?"daily":s?.backup_frequency||"daily"})}catch(r){e({error:r instanceof Error?r.message:"فشل في تحميل قائمة النسخ الاحتياطية",isLoading:!1})}},createBackup:async(s,a)=>{e({isCreatingBackup:!0,error:null});try{const t=await window.electronAPI.backup.create(s,a);return await r().loadBackups(),e({isCreatingBackup:!1}),t}catch(t){throw e({error:t instanceof Error?t.message:"فشل في إنشاء النسخة الاحتياطية",isCreatingBackup:!1}),t}},restoreBackup:async r=>{e({isRestoringBackup:!0,error:null});try{const s=await window.electronAPI.backup.restore(r);return e({isRestoringBackup:!1}),s}catch(s){throw e({error:s instanceof Error?s.message:"فشل في استعادة النسخة الاحتياطية",isRestoringBackup:!1}),s}},deleteBackup:async s=>{e({isLoading:!0,error:null});try{await window.electronAPI.backup.delete(s),await r().loadBackups()}catch(a){throw e({error:a instanceof Error?a.message:"فشل في حذف النسخة الاحتياطية",isLoading:!1}),a}},setAutoBackupEnabled:async s=>{e({autoBackupEnabled:s});try{const e=r().backupFrequency,a="monthly"===e?"weekly":e;await window.electronAPI.settings.update({backup_frequency:s?a:"disabled"})}catch(a){console.error("Failed to update backup settings:",a)}},setBackupFrequency:async s=>{e({backupFrequency:s});const{autoBackupEnabled:a}=r();if(a)try{const e="monthly"===s?"weekly":s;await window.electronAPI.settings.update({backup_frequency:e})}catch(t){console.error("Failed to update backup frequency:",t)}},selectBackupFile:async()=>{try{const e=await window.electronAPI.dialog.showOpenDialog({title:"اختر ملف النسخة الاحتياطية",filters:[{name:"نسخ احتياطية مع صور",extensions:["zip"]},{name:"ملفات قاعدة البيانات",extensions:["db","sqlite"]},{name:"ملفات النسخ الاحتياطية القديمة",extensions:["json"]},{name:"ملفات النسخ الاحتياطية الأخرى",extensions:["backup","bak"]},{name:"جميع الملفات",extensions:["*"]}],properties:["openFile"]});return e.canceled?null:e.filePaths[0]}catch(r){return e({error:r instanceof Error?r.message:"فشل في اختيار الملف"}),null}},runBackupTest:async()=>{e({isLoading:!0,error:null});try{const r=await window.electronAPI.backup.test();return e({isLoading:!1}),r}catch(r){return e({error:r instanceof Error?r.message:"فشل في تشغيل اختبار النسخ الاحتياطي",isLoading:!1}),{success:!1,results:[],error:r instanceof Error?r.message:"Unknown error"}}},clearError:()=>{e({error:null})},formatBackupSize:e=>{if(0===e)return"0 بايت";const r=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,r)*100)/100+" "+["بايت","كيلوبايت","ميجابايت","جيجابايت"][r]},formatBackupDate:e=>{const r=new Date(e),s=r.getDate(),a=r.getMonth()+1,t=r.getFullYear(),o=r.getHours(),l=r.getMinutes();return`${s.toString().padStart(2,"0")}/${a.toString().padStart(2,"0")}/${t} في ${o.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`},getBackupStatus:()=>{const{backups:e,backupFrequency:s,lastBackupDate:a}=r();let t=null;if(a){const e=new Date(a),r=new Date(e);switch(s){case"daily":r.setDate(r.getDate()+1);break;case"weekly":r.setDate(r.getDate()+7);break;case"monthly":r.setMonth(r.getMonth()+1)}const o=r.getDate(),l=r.getMonth()+1,d=r.getFullYear();t=`${o.toString().padStart(2,"0")}/${l.toString().padStart(2,"0")}/${d}`}return{totalBackups:e.length,lastBackup:a?r().formatBackupDate(a):null,nextScheduledBackup:t}}}),{name:"backup-store"})),Qe=["ما هو اسم أول مدرسة التحقت بها؟","ما هو اسم حيوانك الأليف الأول؟","في أي مدينة ولدت؟","ما هو اسم أفضل صديق لك في الطفولة؟","ما هو لقب والدتك؟","ما هو اسم الشارع الذي نشأت فيه؟","ما هو اسم مدرستك الثانوية؟","ما هو طعامك المفضل؟","ما هو اسم أول شركة عملت بها؟","ما هو رقمك المفضل؟"];
/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */function Fe({open:s,onOpenChange:a,onSave:t,editMode:S=!1}){const[C,R]=r.useState("predefined"),[A,P]=r.useState(""),[_,E]=r.useState(""),[I,Q]=r.useState(""),[F,B]=r.useState(!1),[q,L]=r.useState(""),[D,M]=r.useState(""),[T,z]=r.useState("");r.useEffect(()=>{s&&($(),R("predefined"),P(""),E(""),Q(""),L(""),M(""))},[s]);const $=async()=>{if(S)try{const e=await window.electronAPI.settings.get();e?.security_question&&z(e.security_question)}catch(e){console.error("Error loading current security question:",e)}},K=async()=>{const e="predefined"===C?A:_;if(e.trim())if(I.trim())if(I.trim().length<2)L("إجابة سؤال الأمان يجب أن تكون حرفين على الأقل");else{B(!0),L("");try{const r=await N(I.trim().toLowerCase());await window.electronAPI.settings.update({security_question:e.trim(),security_answer:r}),M(S?"تم تحديث سؤال الأمان بنجاح":"تم حفظ سؤال الأمان بنجاح"),setTimeout(()=>{t(),a(!1)},2e3)}catch(r){console.error("Error saving security question:",r),L("حدث خطأ في حفظ سؤال الأمان")}finally{B(!1)}}else L("يرجى إدخال إجابة سؤال الأمان");else L("يرجى اختيار أو إدخال سؤال الأمان")},O=()=>{R("predefined"),P(""),E(""),Q(""),L(""),M(""),a(!1)};return e.jsx(o,{open:s,onOpenChange:O,children:e.jsxs(l,{className:"sm:max-w-lg",dir:"rtl",children:[e.jsx(d,{children:e.jsxs(n,{className:"flex items-center gap-2 text-right",children:[e.jsx(i,{className:"w-5 h-5 text-primary"}),S?"تحديث سؤال الأمان":"إعداد سؤال الأمان"]})}),e.jsxs("div",{className:"space-y-6",children:[S&&T&&e.jsx("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(c,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-800 dark:text-blue-200 mb-1",children:"سؤال الأمان الحالي"}),e.jsx("p",{className:"text-blue-700 dark:text-blue-300",children:T})]})]})}),e.jsxs(m,{children:[e.jsx(x,{className:"h-4 w-4"}),e.jsx(u,{children:"سؤال الأمان يُستخدم لاستعادة كلمة المرور في حالة نسيانها. اختر سؤالاً تتذكر إجابته بسهولة ولا يمكن للآخرين تخمينها."})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(h,{children:"نوع السؤال"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center space-x-2 space-x-reverse cursor-pointer",children:[e.jsx("input",{type:"radio",name:"questionType",value:"predefined",checked:"predefined"===C,onChange:e=>R(e.target.value),className:"text-primary"}),e.jsx("span",{children:"اختيار من القائمة"})]}),e.jsxs("label",{className:"flex items-center space-x-2 space-x-reverse cursor-pointer",children:[e.jsx("input",{type:"radio",name:"questionType",value:"custom",checked:"custom"===C,onChange:e=>R(e.target.value),className:"text-primary"}),e.jsx("span",{children:"سؤال مخصص"})]})]})]}),"predefined"===C&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"predefinedQuestion",children:"اختر سؤال الأمان"}),e.jsxs(g,{value:A,onValueChange:P,children:[e.jsx(b,{className:"text-right",children:e.jsx(p,{placeholder:"اختر سؤالاً من القائمة"})}),e.jsx(f,{children:Qe.map((r,s)=>e.jsx(w,{value:r,children:r},s))})]})]}),"custom"===C&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"customQuestion",children:"سؤال الأمان المخصص"}),e.jsx(y,{id:"customQuestion",type:"text",value:_,onChange:e=>E(e.target.value),placeholder:"أدخل سؤال الأمان الخاص بك",className:"text-right"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"answer",children:"إجابة سؤال الأمان"}),e.jsx(y,{id:"answer",type:"text",value:I,onChange:e=>Q(e.target.value),placeholder:"أدخل إجابة سؤال الأمان",className:"text-right",onKeyDown:e=>"Enter"===e.key&&K()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"ملاحظة: الإجابة حساسة لحالة الأحرف، تأكد من كتابتها بنفس الطريقة التي ستتذكرها بها"})]}),q&&e.jsxs(m,{variant:"destructive",children:[e.jsx(j,{className:"h-4 w-4"}),e.jsx(u,{children:q})]}),D&&e.jsxs(m,{className:"border-green-200 bg-green-50 text-green-800 dark:border-green-800 dark:bg-green-900/20 dark:text-green-200",children:[e.jsx(v,{className:"h-4 w-4"}),e.jsx(u,{children:D})]}),!D&&e.jsxs("div",{className:"flex gap-3",children:[e.jsx(k,{onClick:K,disabled:F||!A&&!_||!I,className:"flex-1",children:F?"جاري الحفظ...":S?"تحديث":"حفظ"}),e.jsx(k,{variant:"outline",onClick:O,className:"flex-1",children:"إلغاء"})]})]})]})})}function Be({showNotification:s}){const{passwordEnabled:a,setPassword:t,removePassword:o,changePassword:l}=S(),[d,n]=r.useState(!1),[m,u]=r.useState(!1),[h,g]=r.useState(!1),[b,p]=r.useState(!1),[f,w]=r.useState(!1),[y,j]=r.useState(""),[v,k]=r.useState(!1),[N,P]=r.useState(""),[_,E]=r.useState(""),[I,Q]=r.useState(""),[F,B]=r.useState(""),[q,L]=r.useState({new:!1,confirm:!1,old:!1,remove:!1}),[D,M]=r.useState(!1);r.useEffect(()=>{T()},[]);const T=async()=>{try{const e=await window.electronAPI.settings.get();e?.security_question?(j(e.security_question),k(!0)):k(!1)}catch(e){console.error("Error loading security question:",e)}},z=e=>{L(r=>({...r,[e]:!r[e]}))};return e.jsxs("div",{className:"space-y-8",dir:"rtl",children:[e.jsxs("div",{className:"bg-gradient-to-br from-card/50 to-card/30 dark:from-gray-800/50 dark:to-gray-800/30 rounded-2xl shadow-xl border border-border/40 dark:border-gray-700/40 overflow-hidden",children:[e.jsx("div",{className:"p-8 border-b border-border/30 dark:border-gray-700/30 bg-gradient-to-r from-primary/5 to-primary/10 dark:from-primary/10 dark:to-primary/20",children:e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-primary/20 to-primary/10 dark:from-primary/30 dark:to-primary/20",children:e.jsx(i,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-foreground dark:text-white",children:"حماية التطبيق بكلمة مرور"}),e.jsx("p",{className:"text-sm text-muted-foreground dark:text-gray-300 mt-1",children:"تأمين التطبيق بكلمة مرور لمنع الوصول غير المصرح به"})]})]})}),e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center space-x-4 space-x-reverse",children:[e.jsx("div",{className:"p-4 rounded-2xl shadow-lg transition-all duration-300 "+(a?"bg-gradient-to-br from-green-100 to-green-50 dark:from-green-900/30 dark:to-green-800/20":"bg-gradient-to-br from-gray-100 to-gray-50 dark:from-gray-800/50 dark:to-gray-700/30"),children:a?e.jsx(C,{className:"w-6 h-6 text-green-600 dark:text-green-400"}):e.jsx(ce,{className:"w-6 h-6 text-gray-600 dark:text-gray-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-bold text-foreground dark:text-white",children:a?"كلمة المرور مفعلة":"كلمة المرور معطلة"}),e.jsx("p",{className:"text-sm text-muted-foreground dark:text-gray-300",children:a?"التطبيق محمي بكلمة مرور":"التطبيق غير محمي بكلمة مرور"})]})]}),e.jsx("div",{className:"px-4 py-2 rounded-full text-sm font-bold shadow-lg transition-all duration-300 "+(a?"bg-gradient-to-r from-green-500 to-green-600 text-white shadow-green-500/25":"bg-gradient-to-r from-gray-500 to-gray-600 text-white shadow-gray-500/25"),children:a?"مفعل":"معطل"})]}),e.jsx("div",{className:"flex flex-wrap gap-4",children:a?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>u(!0),className:"group flex items-center space-x-3 space-x-reverse px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-300 shadow-lg hover:shadow-xl hover:scale-105 active:scale-95",children:[e.jsx(R,{className:"w-5 h-5 group-hover:rotate-12 transition-transform duration-300"}),e.jsx("span",{className:"font-semibold",children:"تغيير كلمة المرور"})]}),e.jsxs("button",{onClick:()=>p(!0),className:"group flex items-center space-x-3 space-x-reverse px-6 py-3 bg-gradient-to-r from-red-600 to-red-700 text-white rounded-xl hover:from-red-700 hover:to-red-800 transition-all duration-300 shadow-lg hover:shadow-xl hover:scale-105 active:scale-95",children:[e.jsx(ce,{className:"w-5 h-5 group-hover:rotate-12 transition-transform duration-300"}),e.jsx("span",{className:"font-semibold",children:"إزالة كلمة المرور"})]})]}):e.jsxs("button",{onClick:()=>n(!0),className:"group flex items-center space-x-3 space-x-reverse px-6 py-3 bg-gradient-to-r from-primary to-primary/90 text-white rounded-xl hover:from-primary/90 hover:to-primary/80 transition-all duration-300 shadow-lg hover:shadow-xl hover:scale-105 active:scale-95",children:[e.jsx(R,{className:"w-5 h-5 group-hover:rotate-12 transition-transform duration-300"}),e.jsx("span",{className:"font-semibold",children:"تعيين كلمة مرور"})]})}),e.jsx("div",{className:"mt-8 p-6 bg-gradient-to-br from-blue-50 to-blue-100/50 dark:from-blue-900/20 dark:to-blue-800/10 border border-blue-200/50 dark:border-blue-800/50 rounded-2xl shadow-lg",children:e.jsxs("div",{className:"flex items-start space-x-4 space-x-reverse",children:[e.jsx("div",{className:"p-2 rounded-xl bg-gradient-to-br from-blue-100 to-blue-200 dark:from-blue-800/30 dark:to-blue-700/20",children:e.jsx(c,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-bold text-blue-800 dark:text-blue-200 mb-4",children:"معلومات مهمة حول الأمان"}),e.jsxs("ul",{className:"text-sm text-blue-700 dark:text-blue-300 space-y-3",children:[e.jsxs("li",{className:"flex items-start space-x-3 space-x-reverse",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500 mt-2 flex-shrink-0"}),e.jsx("span",{children:"عند تفعيل كلمة المرور، ستحتاج لإدخالها في كل مرة تفتح فيها التطبيق"})]}),e.jsxs("li",{className:"flex items-start space-x-3 space-x-reverse",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500 mt-2 flex-shrink-0"}),e.jsx("span",{children:"يُنصح باستخدام كلمة مرور قوية تحتوي على أرقام وحروف"})]}),e.jsxs("li",{className:"flex items-start space-x-3 space-x-reverse",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500 mt-2 flex-shrink-0"}),e.jsx("span",{children:"احتفظ بكلمة المرور في مكان آمن"})]}),e.jsxs("li",{className:"flex items-start space-x-3 space-x-reverse",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500 mt-2 flex-shrink-0"}),e.jsx("span",{children:"في حالة نسيان كلمة المرور، يمكنك استخدام سؤال الأمان لاستعادتها"})]})]})]})]})})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-card/50 to-card/30 dark:from-gray-800/50 dark:to-gray-800/30 rounded-2xl shadow-xl border border-border/40 dark:border-gray-700/40 overflow-hidden",children:[e.jsx("div",{className:"p-8 border-b border-border/30 dark:border-gray-700/30 bg-gradient-to-r from-amber/5 to-amber/10 dark:from-amber/10 dark:to-amber/20",children:e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-amber/20 to-amber/10 dark:from-amber/30 dark:to-amber/20",children:e.jsx(x,{className:"w-6 h-6 text-amber-600 dark:text-amber-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-foreground dark:text-white",children:"سؤال الأمان"}),e.jsx("p",{className:"text-sm text-muted-foreground dark:text-gray-300 mt-1",children:"إعداد سؤال أمان لاستعادة كلمة المرور في حالة نسيانها"})]})]})}),e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center space-x-4 space-x-reverse",children:[e.jsx("div",{className:"p-4 rounded-2xl shadow-lg transition-all duration-300 "+(v?"bg-gradient-to-br from-green-100 to-green-50 dark:from-green-900/30 dark:to-green-800/20":"bg-gradient-to-br from-gray-100 to-gray-50 dark:from-gray-800/50 dark:to-gray-700/30"),children:v?e.jsx(x,{className:"w-6 h-6 text-green-600 dark:text-green-400"}):e.jsx(x,{className:"w-6 h-6 text-gray-600 dark:text-gray-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-bold text-foreground dark:text-white",children:v?"تم إعداد سؤال الأمان":"لم يتم إعداد سؤال أمان"}),e.jsx("p",{className:"text-sm text-muted-foreground dark:text-gray-300",children:v?"يمكنك استخدام سؤال الأمان لاستعادة كلمة المرور":"قم بإعداد سؤال أمان لاستعادة كلمة المرور"})]})]}),e.jsx("div",{className:"flex space-x-3 space-x-reverse",children:e.jsx("button",{onClick:()=>w(!0),className:"group px-6 py-3 bg-gradient-to-r from-primary to-primary/90 text-white rounded-xl hover:from-primary/90 hover:to-primary/80 transition-all duration-300 shadow-lg hover:shadow-xl hover:scale-105 active:scale-95 flex items-center space-x-3 space-x-reverse",children:v?e.jsxs(e.Fragment,{children:[e.jsx(me,{className:"w-5 h-5 group-hover:rotate-12 transition-transform duration-300"}),e.jsx("span",{className:"font-semibold",children:"تحديث"})]}):e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"w-5 h-5 group-hover:rotate-12 transition-transform duration-300"}),e.jsx("span",{className:"font-semibold",children:"إعداد"})]})})})]}),v&&y&&e.jsx("div",{className:"mb-8 p-6 bg-gradient-to-br from-blue-50 to-blue-100/50 dark:from-blue-900/20 dark:to-blue-800/10 border border-blue-200/50 dark:border-blue-800/50 rounded-2xl shadow-lg",children:e.jsxs("div",{className:"flex items-start space-x-4 space-x-reverse",children:[e.jsx("div",{className:"p-2 rounded-xl bg-gradient-to-br from-blue-100 to-blue-200 dark:from-blue-800/30 dark:to-blue-700/20",children:e.jsx(x,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-bold text-blue-800 dark:text-blue-200 mb-2",children:"سؤال الأمان الحالي"}),e.jsx("p",{className:"text-blue-700 dark:text-blue-300 font-medium",children:y})]})]})}),e.jsx("div",{className:"p-6 bg-gradient-to-br from-amber-50 to-amber-100/50 dark:from-amber-900/20 dark:to-amber-800/10 border border-amber-200/50 dark:border-amber-800/50 rounded-2xl shadow-lg",children:e.jsxs("div",{className:"flex items-start space-x-4 space-x-reverse",children:[e.jsx("div",{className:"p-2 rounded-xl bg-gradient-to-br from-amber-100 to-amber-200 dark:from-amber-800/30 dark:to-amber-700/20",children:e.jsx(c,{className:"w-6 h-6 text-amber-600 dark:text-amber-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-bold text-amber-800 dark:text-amber-200 mb-4",children:"نصائح مهمة لسؤال الأمان"}),e.jsxs("ul",{className:"text-sm text-amber-700 dark:text-amber-300 space-y-3",children:[e.jsxs("li",{className:"flex items-start space-x-3 space-x-reverse",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-amber-500 mt-2 flex-shrink-0"}),e.jsx("span",{children:"اختر سؤالاً تتذكر إجابته بسهولة"})]}),e.jsxs("li",{className:"flex items-start space-x-3 space-x-reverse",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-amber-500 mt-2 flex-shrink-0"}),e.jsx("span",{children:"تأكد من أن الإجابة لا يمكن للآخرين تخمينها"})]}),e.jsxs("li",{className:"flex items-start space-x-3 space-x-reverse",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-amber-500 mt-2 flex-shrink-0"}),e.jsx("span",{children:"تجنب الأسئلة التي قد تتغير إجابتها مع الوقت"})]}),e.jsxs("li",{className:"flex items-start space-x-3 space-x-reverse",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-amber-500 mt-2 flex-shrink-0"}),e.jsx("span",{children:"احتفظ بإجابة السؤال في مكان آمن"})]})]})]})]})})]})]}),d&&e.jsxs(Le,{title:"تعيين كلمة مرور جديدة",onSubmit:async e=>{if(e.preventDefault(),N.trim())if(N.length<4)s("كلمة المرور يجب أن تكون 4 أحرف على الأقل","error");else if(N===_){M(!0);try{console.log("🔐 SecuritySettings: Setting password...");const e=await t(N);console.log("🔐 SecuritySettings: Password set result:",e),e?(s("تم تعيين كلمة المرور بنجاح","success"),n(!1),P(""),E(""),L({new:!1,confirm:!1,old:!1,remove:!1})):s("فشل في تعيين كلمة المرور","error")}catch(r){console.error("❌ SecuritySettings: Error setting password:",r),s("حدث خطأ أثناء تعيين كلمة المرور","error")}finally{M(!1)}}else s("كلمة المرور وتأكيدها غير متطابقين","error");else s("يرجى إدخال كلمة مرور","error")},onCancel:()=>{n(!1),P(""),E("")},isLoading:D,children:[e.jsx(qe,{label:"كلمة المرور الجديدة",value:N,onChange:P,show:q.new,onToggleShow:()=>z("new"),placeholder:"أدخل كلمة مرور جديدة"}),e.jsx(qe,{label:"تأكيد كلمة المرور",value:_,onChange:E,show:q.confirm,onToggleShow:()=>z("confirm"),placeholder:"أعد إدخال كلمة المرور"})]}),m&&e.jsxs(Le,{title:"تغيير كلمة المرور",onSubmit:async e=>{if(e.preventDefault(),I.trim()&&N.trim())if(N.length<4)s("كلمة المرور الجديدة يجب أن تكون 4 أحرف على الأقل","error");else if(N===_){M(!0);try{console.log("🔐 SecuritySettings: Changing password...");const e=await l(I,N);console.log("🔐 SecuritySettings: Password change result:",e),e?(s("تم تغيير كلمة المرور بنجاح","success"),u(!1),Q(""),P(""),E(""),L({new:!1,confirm:!1,old:!1,remove:!1})):s("كلمة المرور القديمة غير صحيحة","error")}catch(r){console.error("❌ SecuritySettings: Error changing password:",r),s("حدث خطأ أثناء تغيير كلمة المرور","error")}finally{M(!1)}}else s("كلمة المرور الجديدة وتأكيدها غير متطابقين","error");else s("يرجى ملء جميع الحقول","error")},onCancel:()=>{u(!1),Q(""),P(""),E("")},isLoading:D,children:[e.jsx(qe,{label:"كلمة المرور الحالية",value:I,onChange:Q,show:q.old,onToggleShow:()=>z("old"),placeholder:"أدخل كلمة المرور الحالية"}),e.jsx(qe,{label:"كلمة المرور الجديدة",value:N,onChange:P,show:q.new,onToggleShow:()=>z("new"),placeholder:"أدخل كلمة مرور جديدة"}),e.jsx(qe,{label:"تأكيد كلمة المرور الجديدة",value:_,onChange:E,show:q.confirm,onToggleShow:()=>z("confirm"),placeholder:"أعد إدخال كلمة المرور الجديدة"})]}),b&&e.jsxs(Le,{title:"إزالة كلمة المرور",onSubmit:async e=>{if(e.preventDefault(),F.trim()){M(!0);try{console.log("🔐 SecuritySettings: Verifying password for removal...");const e=await window.electronAPI.settings.get();if(!e?.app_password)return s("لا توجد كلمة مرور مُعيّنة","error"),void M(!1);if(await async function(e){try{const r=(new TextEncoder).encode(e+"dental_clinic_salt_2024"),s=await crypto.subtle.digest("SHA-256",r);return Array.from(new Uint8Array(s)).map(e=>e.toString(16).padStart(2,"0")).join("")}catch(r){throw console.error("Error hashing password:",r),r}}(F)!==e.app_password)return s("كلمة المرور غير صحيحة","error"),void M(!1);console.log("🔐 SecuritySettings: Password verified, removing...");const r=await o();console.log("🔐 SecuritySettings: Password removal result:",r),r?(s("تم إزالة كلمة المرور بنجاح","success"),p(!1),B(""),L(e=>({...e,remove:!1}))):s("فشل في إزالة كلمة المرور","error")}catch(r){console.error("❌ SecuritySettings: Error removing password:",r),s("حدث خطأ أثناء إزالة كلمة المرور","error")}finally{M(!1)}}else s("يرجى إدخال كلمة المرور الحالية","error")},onCancel:()=>{p(!1),B(""),L(e=>({...e,remove:!1}))},isLoading:D,children:[e.jsx("div",{className:"mb-4 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3 space-x-reverse",children:[e.jsx(A,{className:"w-5 h-5 text-red-600 dark:text-red-400 mt-0.5 flex-shrink-0"}),e.jsx("div",{children:e.jsx("p",{className:"text-sm text-red-800 dark:text-red-200",children:"تحذير: إزالة كلمة المرور ستجعل التطبيق غير محمي. يرجى إدخال كلمة المرور الحالية للتأكيد."})})]})}),e.jsx(qe,{label:"كلمة المرور الحالية",value:F,onChange:B,show:q.remove,onToggleShow:()=>z("remove"),placeholder:"أدخل كلمة المرور الحالية"})]}),h&&e.jsx(De,{title:"إزالة كلمة المرور",message:"هل أنت متأكد من إزالة كلمة المرور؟ سيصبح التطبيق غير محمي.",onConfirm:async()=>{M(!0);try{console.log("🔐 SecuritySettings: Removing password...");const e=await o();console.log("🔐 SecuritySettings: Password removal result:",e),e?(s("تم إزالة كلمة المرور بنجاح","success"),g(!1)):s("فشل في إزالة كلمة المرور","error")}catch(e){console.error("❌ SecuritySettings: Error removing password:",e),s("حدث خطأ أثناء إزالة كلمة المرور","error")}finally{M(!1)}},onCancel:()=>g(!1),isLoading:D,confirmText:"إزالة",confirmClass:"bg-red-600 hover:bg-red-700"}),e.jsx(Fe,{open:f,onOpenChange:w,onSave:()=>{T(),s("تم حفظ سؤال الأمان بنجاح","success")},editMode:v})]})}function qe({label:r,value:s,onChange:a,show:t,onToggleShow:o,placeholder:l}){return e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-foreground",children:r}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:t?"text":"password",value:s,onChange:e=>a(e.target.value),className:"w-full pr-3 pl-10 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",placeholder:l}),e.jsx("button",{type:"button",onClick:o,className:"absolute inset-y-0 left-0 pl-3 flex items-center text-muted-foreground hover:text-foreground",children:t?e.jsx(P,{className:"w-4 h-4"}):e.jsx(_,{className:"w-4 h-4"})})]})]})}function Le({title:r,children:s,onSubmit:a,onCancel:t,isLoading:o}){return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:t}),e.jsx("div",{className:"relative bg-card border border-border rounded-lg shadow-2xl max-w-md w-full mx-4",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-4",children:r}),e.jsxs("form",{onSubmit:a,className:"space-y-4",children:[s,e.jsxs("div",{className:"flex justify-end space-x-3 space-x-reverse pt-4",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-input bg-background text-foreground rounded-lg hover:bg-accent",children:"إلغاء"}),e.jsx("button",{type:"submit",disabled:o,className:"px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 disabled:opacity-50",children:o?"جاري الحفظ...":"حفظ"})]})]})]})})]})}function De({title:r,message:s,onConfirm:a,onCancel:t,isLoading:o,confirmText:l,confirmClass:d}){return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:t}),e.jsx("div",{className:"relative bg-card border border-border rounded-lg shadow-2xl max-w-md w-full mx-4",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-red-100 dark:bg-red-900/20 rounded-full flex items-center justify-center ml-3",children:e.jsx(A,{className:"w-5 h-5 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:r}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 space-x-reverse",children:[e.jsx("button",{onClick:t,className:"px-4 py-2 border border-input bg-background text-foreground rounded-lg hover:bg-accent",children:"إلغاء"}),e.jsx("button",{onClick:a,disabled:o,className:`px-4 py-2 text-white rounded-lg transition-colors disabled:opacity-50 ${d}`,children:o?"جاري التنفيذ...":l})]})]})})]})}const Me=[{key:"0",arabicKey:"٠",description:"لوحة التحكم",icon:e.jsx(Pe,{className:"w-4 h-4"}),category:"تنقل"},{key:"1",arabicKey:"١",description:"المرضى",icon:e.jsx(xe,{className:"w-4 h-4"}),category:"تنقل"},{key:"2",arabicKey:"٢",description:"المواعيد",icon:e.jsx(D,{className:"w-4 h-4"}),category:"تنقل"},{key:"3",arabicKey:"٣",description:"المدفوعات",icon:e.jsx(M,{className:"w-4 h-4"}),category:"تنقل"},{key:"4",arabicKey:"٤",description:"المختبرات",icon:e.jsx(Ae,{className:"w-4 h-4"}),category:"تنقل"},{key:"5",arabicKey:"٥",description:"العلاجات السنية",icon:e.jsx(ue,{className:"w-4 h-4"}),category:"تنقل"},{key:"6",arabicKey:"٦",description:"مصروفات العيادة",icon:e.jsx(he,{className:"w-4 h-4"}),category:"تنقل"},{key:"7",arabicKey:"٧",description:"التقارير",icon:e.jsx(ge,{className:"w-4 h-4"}),category:"تنقل"},{key:"8",arabicKey:"٨",description:"الإعدادات",icon:e.jsx(be,{className:"w-4 h-4"}),category:"تنقل"},{key:"A",arabicKey:"ش",description:"إضافة مريض جديد",icon:e.jsx(pe,{className:"w-4 h-4"}),category:"إجراءات"},{key:"S",arabicKey:"س",description:"إضافة موعد جديد",icon:e.jsx(pe,{className:"w-4 h-4"}),category:"إجراءات"},{key:"D",arabicKey:"ي",description:"إضافة دفعة جديدة",icon:e.jsx(pe,{className:"w-4 h-4"}),category:"إجراءات"},{key:"F1",arabicKey:"F1",description:"فتح الإعدادات",icon:e.jsx(be,{className:"w-4 h-4"}),category:"عمليات"},{key:"R",arabicKey:"ق",description:"تحديث الصفحة",icon:e.jsx(T,{className:"w-4 h-4"}),category:"عمليات"},{key:"F",arabicKey:"ب",description:"فتح البحث",icon:e.jsx(z,{className:"w-4 h-4"}),category:"عمليات"},{key:"ESC",arabicKey:"ESC",description:"إغلاق النوافذ",icon:e.jsx($,{className:"w-4 h-4"}),category:"عمليات"}];function Te({className:s,compact:a=!1}){const{isDarkMode:t}=E(),[o,l]=r.useState(!1),[d,n]=r.useState(null),i=Array.from(new Set(Me.map(e=>e.category))),c=d?Me.filter(e=>e.category===d):Me;return a?e.jsx("div",{className:I("fixed bottom-4 right-4 z-50",s),children:e.jsx(Q,{className:I("shadow-xl border backdrop-blur-sm",t?"border-border/30 bg-gradient-to-br from-background/90 to-muted/90 shadow-2xl shadow-black/30":"border-border/50 bg-gradient-to-br from-background/95 to-muted/95 shadow-lg"),children:e.jsxs(F,{className:"p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:I("p-1.5 rounded-md",t?"bg-primary/20":"bg-primary/10"),children:e.jsx(_e,{className:"w-4 h-4 text-primary"})}),e.jsx("span",{className:"text-sm font-semibold text-foreground",children:"اختصارات سريعة"})]}),e.jsx(k,{variant:"ghost",size:"sm",onClick:()=>l(!o),className:I("h-7 w-7 p-0 rounded-md transition-all duration-200",t?"text-muted-foreground hover:text-foreground hover:bg-muted/30":"text-muted-foreground hover:text-foreground hover:bg-muted/50"),children:o?e.jsx(B,{className:"w-3.5 h-3.5"}):e.jsx(q,{className:"w-3.5 h-3.5"})})]}),o&&e.jsxs("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:[e.jsxs("div",{className:"flex gap-1.5 flex-wrap",children:[e.jsx(k,{variant:null===d?"default":"outline",size:"sm",onClick:()=>n(null),className:"h-7 text-xs px-3 rounded-full transition-all duration-200 hover:scale-105",children:"الكل"}),i.map(r=>e.jsx(k,{variant:d===r?"default":"outline",size:"sm",onClick:()=>n(r),className:"h-7 text-xs px-3 rounded-full transition-all duration-200 hover:scale-105",children:r},r))]}),e.jsx("div",{className:"space-y-1.5",children:c.map((r,s)=>e.jsxs("div",{className:"flex items-center justify-between p-2.5 rounded-lg bg-card/50 border border-border/30 hover:bg-card/80 hover:border-border/60 transition-all duration-200 hover:shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"p-1 rounded-md bg-muted/50",children:r.icon}),e.jsx("span",{className:"text-xs text-foreground font-medium",children:r.description})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(L,{variant:"secondary",className:"text-xs px-2 py-0.5 bg-primary/10 text-primary border-primary/20 font-mono font-semibold",children:r.key}),r.arabicKey!==r.key&&e.jsx(L,{variant:"outline",className:"text-xs px-2 py-0.5 border-emerald-200 text-emerald-700 dark:border-emerald-800 dark:text-emerald-300 font-mono font-semibold",children:r.arabicKey})]})]},s))})]})]})})}):e.jsxs("div",{className:I("w-full",s),children:[e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-primary/20 to-primary/10 dark:from-primary/30 dark:to-primary/20",children:e.jsx(_e,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-2xl text-foreground dark:text-white",children:"اختصارات لوحة المفاتيح"}),e.jsx("p",{className:"text-sm text-muted-foreground dark:text-gray-300 mt-1",children:"تعرف على جميع اختصارات لوحة المفاتيح المتاحة لتسريع عملك"})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:i.map((r,s)=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-gradient-to-r from-primary to-primary/70 shadow-lg"}),e.jsx("div",{className:"absolute -top-1 -right-1 w-2 h-2 rounded-full bg-primary/40 animate-pulse"})]}),e.jsx("h4",{className:"font-bold text-xl bg-gradient-to-r from-foreground to-foreground/80 dark:from-white dark:to-white/80 bg-clip-text text-transparent",children:r})]}),e.jsx("div",{className:"space-y-3",children:Me.filter(e=>e.category===r).map((r,s)=>e.jsxs("div",{className:"group flex items-center justify-between p-4 rounded-xl bg-gradient-to-r from-card/50 to-card/30 dark:from-gray-800/50 dark:to-gray-800/30 border border-border/40 dark:border-gray-700/40 hover:from-card/80 hover:to-card/60 dark:hover:from-gray-800/80 dark:hover:to-gray-800/60 hover:border-border/60 dark:hover:border-gray-700/60 hover:shadow-lg hover:shadow-primary/5 dark:hover:shadow-primary/10 transition-all duration-300 hover:scale-[1.02]",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-primary/10 to-primary/5 dark:from-primary/20 dark:to-primary/10 group-hover:from-primary/20 group-hover:to-primary/10 dark:group-hover:from-primary/30 dark:group-hover:to-primary/20 transition-all duration-300",children:r.icon}),e.jsx("span",{className:"text-sm font-semibold text-foreground dark:text-white group-hover:text-primary dark:group-hover:text-primary/90 transition-colors duration-300",children:r.description})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{variant:"secondary",className:"text-xs px-3 py-1.5 bg-gradient-to-r from-primary/20 to-primary/10 dark:from-primary/30 dark:to-primary/20 text-primary border-primary/30 dark:border-primary/40 font-mono font-bold shadow-sm group-hover:shadow-md group-hover:scale-105 transition-all duration-300",children:r.key}),r.arabicKey!==r.key&&e.jsx(L,{variant:"outline",className:"text-xs px-3 py-1.5 border-emerald-300 dark:border-emerald-600 text-emerald-700 dark:text-emerald-300 bg-emerald-50 dark:bg-emerald-900/20 font-mono font-bold shadow-sm group-hover:shadow-md group-hover:scale-105 transition-all duration-300",children:r.arabicKey})]})]},s))})]},r))})]})}function ze(){const[s,a]=r.useState(null),[t,o]=r.useState(!1),l=async()=>{o(!0);try{if(!window.electronAPI?.database?.getStatus)throw new Error("Database API not available");const e=await window.electronAPI.database.getStatus();a(e)}catch(e){console.error("Database status check failed:",e),a({connected:!1,error:e instanceof Error?e.message:"Unknown error"})}finally{o(!1)}};r.useEffect(()=>{l()},[]);return e.jsx("div",{className:"w-full h-full flex flex-col",children:e.jsxs(Q,{className:"w-full h-full flex flex-col",children:[e.jsx(K,{className:"flex-shrink-0",children:e.jsxs(O,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-5 w-5"}),"تشخيص قاعدة البيانات"]})}),e.jsxs(F,{className:"space-y-4 flex-1 flex flex-col overflow-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[e.jsx("span",{className:"font-medium",children:"حالة الاتصال:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[s?s.connected?e.jsx(v,{className:"h-4 w-4 text-green-600 dark:text-green-400"}):e.jsx(j,{className:"h-4 w-4 text-red-600 dark:text-red-400"}):e.jsx(U,{className:"h-4 w-4"}),e.jsx(L,{variant:s?.connected?"default":"destructive",children:s?.connected?"متصل":"غير متصل"})]})]}),s?.dbPath&&e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[e.jsx("span",{className:"font-medium",children:"مسار قاعدة البيانات:"}),e.jsx("code",{className:"text-sm bg-gray-500 dark:bg-gray-700 dark:text-gray-100 px-2 py-1 rounded border dark:border-gray-600",children:s.dbPath})]}),void 0!==s?.tablesCount&&e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[e.jsx("span",{className:"font-medium",children:"عدد الجداول:"}),e.jsx(L,{variant:"outline",children:s.tablesCount})]}),void 0!==s?.isOpen&&e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[e.jsx("span",{className:"font-medium",children:"حالة قاعدة البيانات:"}),e.jsx(L,{variant:s.isOpen?"default":"secondary",children:s.isOpen?"مفتوحة":"مغلقة"})]}),s?.fileSize&&e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[e.jsx("span",{className:"font-medium",children:"حجم الملف:"}),e.jsx(L,{variant:"outline",children:s.fileSize})]}),s?.lastModified&&e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[e.jsx("span",{className:"font-medium",children:"آخر تعديل:"}),e.jsx("code",{className:"text-xs bg-gray-500 dark:bg-gray-700 dark:text-gray-100 px-2 py-1 rounded border dark:border-gray-600",children:new Date(s.lastModified).toLocaleString("ar-EG")})]}),s?.tableNames&&s.tableNames.length>0&&e.jsxs("div",{className:"space-y-2 flex-1 p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[e.jsx("span",{className:"font-medium",children:"الجداول الموجودة:"}),e.jsxs("div",{className:"flex flex-wrap gap-2 max-h-40 overflow-y-auto",children:[s.tableNames.map((r,s)=>e.jsx(L,{variant:"secondary",className:"text-xs",children:r},s)),s.hasMoreTables&&e.jsx(L,{variant:"outline",className:"text-xs",children:"+المزيد..."})]})]}),s?.error&&e.jsxs("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md",children:[e.jsxs("div",{className:"flex items-center gap-2 text-red-800 dark:text-red-400",children:[e.jsx(j,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"خطأ:"})]}),e.jsx("p",{className:"text-red-700 dark:text-red-300 mt-1 text-sm",children:s.error})]}),e.jsx("div",{className:"flex-shrink-0 mt-auto",children:e.jsx(k,{onClick:l,disabled:t,className:"w-full",children:t?e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"h-4 w-4 mr-2 animate-spin"}),"جاري الفحص..."]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"إعادة فحص"]})})})]})]})})}function $e(){const[a,t]=r.useState("backup"),[o,l]=r.useState(null),[d,n]=r.useState({message:"",type:"success",show:!1}),[m,x]=r.useState(!1),[u,h]=r.useState(24),[g,b]=r.useState(0),[p,f]=r.useState(""),[w,y]=r.useState(!1),[j,v]=r.useState(!1),[k,N]=r.useState(!1),[S,C]=r.useState(!1),[P,_]=r.useState(!1),[I,Q]=r.useState(""),[F,B]=r.useState(""),[q,L]=r.useState(!1),[z,$]=r.useState(!1),[K,O]=r.useState(""),ie=r.useRef(null),[ce,me]=r.useState({isConnected:!1,isConnecting:!1,lastActivity:null,qrAvailable:!1}),{backups:ue,isLoading:he,error:ge,isCreatingBackup:pe,isRestoringBackup:Ae,autoBackupEnabled:Pe,backupFrequency:Qe,loadBackups:Fe,createBackup:qe,restoreBackup:Le,deleteBackup:De,setAutoBackupEnabled:Me,setBackupFrequency:$e,selectBackupFile:Ke,clearError:Oe,formatBackupSize:Ue,formatBackupDate:Ve,getBackupStatus:We}=Ie(),{settings:Ge,updateSettings:He,loadSettings:Xe}=V(),{isDarkMode:Ze,toggleDarkMode:Ye}=E(),{currentCurrency:Je,setCurrency:er}=W(),rr=G(),{refreshAllImages:sr}=H(),[ar,tr]=r.useState(""),[or,lr]=r.useState(!1),[dr,nr]=r.useState("");r.useEffect(()=>{Fe(),Xe(),ir()},[Fe,Xe]);const ir=async()=>{try{if(window.electronAPI?.whatsappReminders?.getStatus){const e=await window.electronAPI.whatsappReminders.getStatus(),r=e.isReady&&("connected"===e.state||"authenticated"===e.state),s=e.hasQr||!!e.qr;me({isConnected:r,isConnecting:Boolean(s&&!r),lastActivity:e.lastReadyAt?new Date(e.lastReadyAt).toLocaleString("en-US"):null,qrAvailable:e.hasQr||!!e.qr})}}catch(e){console.warn("Failed to get WhatsApp status:",e),me({isConnected:!1,isConnecting:!1,lastActivity:null,qrAvailable:!1})}};r.useEffect(()=>{const e=setInterval(ir,3e4);return()=>clearInterval(e)},[]),r.useEffect(()=>{if(window.electronAPI){const e=(e,r)=>{mr(r.message,"success"),ir()},r=(e,r)=>{mr(r.message,"success"),ir()};return window.electronAPI.on("whatsapp:session:connected",e),window.electronAPI.on("whatsapp:session:deleted",r),()=>{window.electronAPI.removeListener&&(window.electronAPI.removeListener("whatsapp:session:connected",e),window.electronAPI.removeListener("whatsapp:session:deleted",r))}}},[]),r.useEffect(()=>{tr(rr)},[rr]),r.useEffect(()=>{ge&&(mr(ge,"error"),Oe())},[ge,Oe]),r.useEffect(()=>{},[o]),r.useEffect(()=>{if(!P)return;(async()=>{try{if(window.electronAPI?.whatsappReminders?.getStatus){const e=await window.electronAPI.whatsappReminders.getStatus();if(e.qr)return void Q(e.qr)}}catch(e){console.warn("Failed to check existing QR status:",e)}})();const e=(e,r)=>{Q(r)},r=(e,r)=>{mr("تم ربط واتساب بنجاح!","success"),_(!1),ir()},s=(e,r)=>{mr(r?.message||"تم ربط واتساب بنجاح!","success"),ir()},a=(e,r)=>{mr("فشل في ربط واتساب. يرجى المحاولة مرة أخرى.","error")},t=(e,r)=>{Q(""),mr("تم مسح جلسة واتساب","info")},o=(e,r)=>{mr(`فشل في الاتصال: ${r?.message||"خطأ غير معروف"}`,"error")},l=(e,r)=>{mr(`فشل في تهيئة واتساب: ${r?.message||"خطأ غير معروف"}`,"error")},d=(e,r)=>{mr("تم مسح جلسة واتساب تلقائياً بسبب خطأ 401. يرجى مسح رمز QR مرة أخرى.","info"),Q(""),setTimeout(async()=>{try{const e=await(window.electronAPI?.whatsappReminders?.generateNewQR?.());if(e?.success)mr("تم بدء عملية توليد رمز QR جديد","info");else{console.warn("⚠️ Auto-retry QR generation failed:",e?.error||"Unknown error");const r=e?.details;let s="فشل في توليد رمز QR بعد مسح الجلسة";e?.error&&"Unknown error"!==e.error?s+=`: ${e.error}`:r?(s+=`: ${r.type}`,"N/A"!==r.code&&(s+=` (${r.code})`)):s+=": خطأ غير معروف",mr(s,"error"),r&&console.error("📊 Auto-retry detailed error info:",{type:r.type,code:r.code,stack:r.stack}),console.error("📊 Full auto-retry generateResult object:",e)}}catch(e){console.error("Error auto-retrying QR generation:",e)}},2e3)};try{const n=window.electronAPI?.on("whatsapp:qr",e),i=window.electronAPI?.on("whatsapp:ready",r),c=window.electronAPI?.on("whatsapp:session:connected",s),m=window.electronAPI?.on("whatsapp:auth_failure",a),x=window.electronAPI?.on("whatsapp:session_cleared",t),u=window.electronAPI?.on("whatsapp:connection_failure",o),h=window.electronAPI?.on("whatsapp:init_failure",l),g=window.electronAPI?.on("whatsapp:session_auto_cleared",d);return()=>{try{"function"==typeof n&&n(),"function"==typeof i&&i(),"function"==typeof c&&c(),"function"==typeof m&&m(),"function"==typeof x&&x(),"function"==typeof u&&u(),"function"==typeof h&&h(),"function"==typeof g&&g()}catch(e){console.warn("Error unsubscribing from events:",e)}}}catch(n){console.error("❌ Error setting up event listeners:",n)}},[P]),r.useEffect(()=>{let e=!1;return(async()=>{if(!I||""===I.trim())return B(""),void O("");try{if(I.length<10)return void console.warn("⚠️ QR data too short, may be invalid:",I.substring(0,50));const r=await s.toString(I,{type:"svg",errorCorrectionLevel:"M",margin:2,color:{dark:"#000000",light:"#FFFFFF"},width:512});e||O(r);const a=await s.toDataURL(I,{errorCorrectionLevel:"M",margin:2,width:512});e||B(a)}catch(r){console.error("❌ Failed to generate QR code:",r),console.error("QR Data that failed:",I.substring(0,100)+"..."),e||(B(""),O(""),mr("فشل في توليد رمز QR. يرجى المحاولة مرة أخرى.","error"))}})(),()=>{e=!0}},[I]),r.useEffect(()=>{const e=e=>{o&&"Escape"===e.key&&l(null)};return o?(document.addEventListener("keydown",e),document.body.style.overflow="hidden"):document.body.style.overflow="unset",()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[o]);const cr=async()=>{try{let e;if(window.electronAPI?.whatsappReminders?.getSettings)e=await window.electronAPI.whatsappReminders.getSettings(),x(Boolean(e.whatsapp_reminder_enabled)),h(Number(e.hours_before??24)),b(Number(e.minutes_before??60*(e.hours_before??0))),f(String(e.message??"")),y(Boolean(e.custom_enabled)),N(!0),C(!0);else if(window.electron?.getWhatsAppSettings){const e=await window.electron.getWhatsAppSettings();x(e.enableReminder||!1),h(e.hoursBefore||24),f(e.messageText||""),y(e.allowCustomMessage||!1),N(!0),C(!0)}else console.warn("WhatsApp settings API not available")}catch(e){console.error("Error fetching WhatsApp settings:",e)}};r.useEffect(()=>{S||cr()},[S]),r.useEffect(()=>{const e=()=>{"visible"!==document.visibilityState||"whatsapp"!==a||k||S||cr()},r=()=>{"whatsapp"!==a||k||S||cr()};return document.addEventListener("visibilitychange",e),window.addEventListener("focus",r),()=>{document.removeEventListener("visibilitychange",e),window.removeEventListener("focus",r)}},[a]),r.useEffect(()=>{"whatsapp"!==a||k||S||cr()},[a,k,S]),r.useEffect(()=>{if("whatsapp"===a&&k&&!j){const e=async()=>{if(!j)try{v(!0);const e={whatsapp_reminder_enabled:m?1:0,hours_before:u,minutes_before:g,message:p,custom_enabled:w?1:0};if(window.electronAPI?.whatsappReminders?.setSettings){await window.electronAPI.whatsappReminders.setSettings(e);setTimeout(async()=>{try{await window.electronAPI.whatsappReminders.getSettings()}catch(e){}},3e3)}}catch(e){console.error("Error auto-saving WhatsApp settings:",e)}finally{setTimeout(()=>v(!1),1e3)}},r=setTimeout(e,2e3);return()=>clearTimeout(r)}},[a,m,u,g,p,w,j,k]),r.useEffect(()=>{const e=async()=>{if("whatsapp"===a)try{const e={whatsapp_reminder_enabled:m?1:0,hours_before:u,minutes_before:g,message:p,custom_enabled:w?1:0};window.electronAPI?.whatsappReminders?.setSettings&&await window.electronAPI.whatsappReminders.setSettings(e)}catch(e){console.error("Error saving WhatsApp settings before unload:",e)}};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[a,m,u,g,p,w]);const mr=(e,r="success")=>{n({message:e,type:r,show:!0}),setTimeout(()=>{n(e=>({...e,show:!1}))},3e3)},xr=e=>{const r=ie.current;if(!r)return void f(r=>(r||"")+e);const s=r.selectionStart??r.value.length,a=r.selectionEnd??r.value.length,t=p.slice(0,s),o=p.slice(a);f(`${t}${e}${o}`),requestAnimationFrame(()=>{r.focus();const a=s+e.length;try{r.setSelectionRange(a,a)}catch{}})},ur=async(e=!1)=>{try{await qe(null,e);mr(e?"تم إنشاء النسخة الاحتياطية مع الصور بنجاح":"تم إنشاء النسخة الاحتياطية بنجاح","success")}catch(r){mr("فشل في إنشاء النسخة الاحتياطية","error")}},hr=async e=>{try{if(window.confirm("هل أنت متأكد من استعادة هذه النسخة الاحتياطية؟ سيتم استبدال جميع البيانات الحالية.")){await Le(e);try{await sr()}catch(r){console.warn("Could not refresh images after restore:",r)}mr("تم استعادة النسخة الاحتياطية بنجاح","success"),window.location.reload()}}catch(r){mr("فشل في استعادة النسخة الاحتياطية","error")}},gr=async e=>{try{void 0!==e.clinic_logo&&tr(e.clinic_logo),await He(e),await Xe(),mr("تم حفظ إعدادات العيادة بنجاح","success")}catch(r){console.error("Error updating settings:",r),mr("فشل في حفظ إعدادات العيادة","error")}},br=We();return e.jsx("div",{className:"min-h-screen bg-background dark:bg-gray-900 flex flex-col",dir:"rtl",children:e.jsx("div",{className:"w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex-1 flex flex-col",children:e.jsxs("div",{className:"space-y-6 py-6 flex-1 flex flex-col min-h-0",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4 bg-card/50 backdrop-blur-sm rounded-xl p-4 sm:p-6 border border-border/50 dark:bg-gray-800/50 dark:border-gray-700/50",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-xl sm:text-2xl lg:text-3xl font-bold text-foreground dark:text-white arabic-enhanced",children:"الإعدادات"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground dark:text-gray-300 mt-2 arabic-enhanced",children:"إدارة إعدادات العيادة والنسخ الاحتياطية"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3 w-full lg:w-auto",children:[e.jsxs("button",{onClick:()=>Fe(),disabled:he,className:"flex items-center justify-center space-x-2 space-x-reverse px-4 py-2 border border-input bg-background text-foreground dark:bg-gray-800 dark:border-gray-600 dark:text-white dark:hover:bg-gray-700 rounded-lg hover:bg-accent disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 ease-in-out interactive-card focus:ring-2 focus:ring-primary/50 focus:ring-offset-2 min-h-[44px] hover:scale-105 active:scale-95",children:[e.jsx(T,{className:"w-4 h-4 "+(he?"animate-spin":"")}),e.jsx("span",{className:"whitespace-nowrap",children:"تحديث"})]}),e.jsxs("button",{onClick:async()=>{const e={"الوضع المظلم":Ze?"مفعل":"معطل","النسخ التلقائية":Pe?"مفعلة":"معطلة","تكرار النسخ":"daily"===Qe?"يومياً":"weekly"===Qe?"أسبوعياً":"شهرياً","إجمالي النسخ الاحتياطية":br.totalBackups,"آخر نسخة احتياطية":br.lastBackup||"لا توجد","تاريخ التصدير":X(new Date)},r="\ufeff"+["الإعداد,القيمة",...Object.entries(e).map(([e,r])=>`"${e}","${r}"`)].join("\n");await fe.convertCSVToExcel(r,"settings",{format:"csv",includeCharts:!1,includeDetails:!0,language:"ar"})},className:"flex items-center justify-center space-x-2 space-x-reverse px-4 py-2 border border-input bg-background text-foreground dark:bg-gray-800 dark:border-gray-600 dark:text-white dark:hover:bg-gray-700 rounded-lg hover:bg-accent disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 ease-in-out interactive-card focus:ring-2 focus:ring-primary/50 focus:ring-offset-2 min-h-[44px] hover:scale-105 active:scale-95",children:[e.jsx(ye,{className:"w-4 h-4"}),e.jsx("span",{className:"whitespace-nowrap",children:"تصدير الإعدادات"})]})]})]}),e.jsx("div",{className:"border-b border-border dark:border-gray-700 sticky top-0 bg-background/95 dark:bg-gray-900/95 backdrop-blur-sm z-10 -mx-4 sm:-mx-6 lg:-mx-8 px-4 sm:px-6 lg:px-8",children:e.jsx("nav",{className:"flex space-x-1 space-x-reverse overflow-x-auto scrollbar-thin scrollbar-thumb-border scrollbar-track-transparent py-3",children:[{id:"diagnostics",name:"تشخيص النظام",icon:A},{id:"appearance",name:"المظهر",icon:Ee},{id:"whatsapp",name:"تذكيرات واتساب",icon:ke},{id:"shortcuts",name:"اختصارات",icon:_e},{id:"security",name:"الأمان",icon:R},{id:"clinic",name:"العيادة",icon:be},{id:"development",name:"التطوير",icon:xe}].map(r=>e.jsxs("button",{onClick:()=>t(r.id),className:"flex items-center space-x-2 space-x-reverse px-4 py-3 border-b-2 font-medium text-sm whitespace-nowrap rounded-t-lg transition-all duration-300 ease-in-out interactive-card w-full sm:w-auto justify-center min-w-fit hover:scale-105 active:scale-95 "+(a===r.id?"border-primary text-primary bg-primary/5 dark:bg-blue-500/20 dark:border-blue-500 dark:text-blue-400 shadow-sm":"border-transparent text-muted-foreground dark:text-gray-300 hover:text-foreground dark:hover:text-white hover:border-border/50 dark:hover:border-gray-600 hover:bg-accent/30 dark:hover:bg-gray-700/50"),"aria-selected":a===r.id,children:[e.jsx(r.icon,{className:"w-4 h-4 transition-colors flex-shrink-0"}),e.jsx("span",{className:"font-medium",children:r.name})]},r.id))})}),"backup"===a&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4 sm:gap-6",children:[e.jsx("div",{className:"bg-card dark:bg-gray-800 rounded-xl shadow-sm border border-border dark:border-gray-700 p-4 sm:p-6 interactive-card transition-all duration-200 hover:shadow-md",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-primary/10 dark:bg-blue-500/20 rounded-xl transition-colors",children:e.jsx(Ne,{className:"w-6 h-6 text-primary dark:text-blue-400"})}),e.jsxs("div",{className:"mr-4 flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground dark:text-gray-300",children:"إجمالي النسخ"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-foreground dark:text-white",children:br.totalBackups})]})]})}),e.jsx("div",{className:"bg-card dark:bg-gray-800 rounded-xl shadow-sm border border-border dark:border-gray-700 p-4 sm:p-6 interactive-card transition-all duration-200 hover:shadow-md",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/20 rounded-xl transition-colors",children:e.jsx(Z,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),e.jsxs("div",{className:"mr-4 flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground dark:text-gray-300",children:"آخر نسخة احتياطية"}),e.jsx("p",{className:"text-sm font-bold text-foreground dark:text-white break-words",children:br.lastBackup||"لا توجد"})]})]})}),e.jsx("div",{className:"bg-card dark:bg-gray-800 rounded-xl shadow-sm border border-border dark:border-gray-700 p-4 sm:p-6 interactive-card transition-all duration-200 hover:shadow-md sm:col-span-2 lg:col-span-1",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/20 rounded-xl transition-colors",children:e.jsx(D,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{className:"mr-4 flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground dark:text-gray-300",children:"النسخة التالية"}),e.jsx("p",{className:"text-sm font-bold text-foreground dark:text-white break-words",children:br.nextScheduledBackup||"غير محدد"})]})]})})]}),e.jsxs("div",{className:"bg-card dark:bg-gray-800 rounded-xl shadow-sm border border-border dark:border-gray-700",children:[e.jsxs("div",{className:"p-4 sm:p-6 border-b border-border dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-foreground dark:text-white",children:"النسخ الاحتياطية اليدوية"}),e.jsx("p",{className:"text-sm text-muted-foreground dark:text-gray-300 mt-1",children:"إنشاء واستعادة النسخ الاحتياطية يدوياً (تنسيق SQLite)"})]}),e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4 flex-wrap",children:[e.jsxs("button",{onClick:()=>ur(!1),disabled:pe,className:"flex items-center justify-center space-x-2 space-x-reverse px-4 sm:px-6 py-3 bg-primary dark:bg-blue-600 text-primary-foreground dark:text-white rounded-lg hover:bg-primary/90 dark:hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 ease-in-out interactive-card focus:ring-2 focus:ring-primary/50 focus:ring-offset-2 min-h-[44px] flex-1 sm:flex-none hover:scale-105 active:scale-95 hover:shadow-lg dark:hover:shadow-blue-500/25",children:[e.jsx(ye,{className:"w-5 h-5"}),e.jsx("span",{className:"whitespace-nowrap",children:pe?"جاري الإنشاء...":"إنشاء نسخة احتياطية"})]}),e.jsxs("button",{onClick:()=>ur(!0),disabled:pe,className:"flex items-center justify-center space-x-2 space-x-reverse px-4 sm:px-6 py-3 bg-blue-600 dark:bg-blue-600 text-white rounded-lg hover:bg-blue-700 dark:hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 ease-in-out interactive-card focus:ring-2 focus:ring-blue-500/50 focus:ring-offset-2 min-h-[44px] flex-1 sm:flex-none hover:scale-105 active:scale-95 hover:shadow-lg dark:hover:shadow-blue-500/25",children:[e.jsx(Se,{className:"w-5 h-5"}),e.jsx("span",{className:"whitespace-nowrap",children:pe?"جاري الإنشاء...":"إنشاء نسخة مع صور"})]}),e.jsxs("button",{onClick:async()=>{try{const r=await Ke();if(!r)return;if(window.confirm("هل أنت متأكد من استعادة هذه النسخة الاحتياطية؟ سيتم استبدال جميع البيانات الحالية.")){await Le(r);try{await sr()}catch(e){console.warn("Could not refresh images after restore:",e)}mr("تم استعادة النسخة الاحتياطية بنجاح","success"),window.location.reload()}}catch(e){mr("فشل في استعادة النسخة الاحتياطية","error")}},disabled:Ae,className:"flex items-center justify-center space-x-2 space-x-reverse px-4 sm:px-6 py-3 bg-green-600 dark:bg-green-600 text-white rounded-lg hover:bg-green-700 dark:hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 ease-in-out interactive-card focus:ring-2 focus:ring-green-500/50 focus:ring-offset-2 min-h-[44px] flex-1 sm:flex-none hover:scale-105 active:scale-95 hover:shadow-lg dark:hover:shadow-green-500/25",children:[e.jsx(je,{className:"w-5 h-5"}),e.jsx("span",{className:"whitespace-nowrap",children:Ae?"جاري الاستعادة...":"استعادة نسخة احتياطية"})]})]}),e.jsx("div",{className:"mt-4 p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg",children:e.jsxs("div",{className:"flex",children:[e.jsx(A,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400 ml-2"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:"تنبيه مهم"}),e.jsx("p",{className:"text-sm text-yellow-700 dark:text-yellow-300 mt-1",children:"استعادة النسخة الاحتياطية ستستبدل جميع البيانات الحالية. تأكد من إنشاء نسخة احتياطية حديثة قبل الاستعادة."}),e.jsx("p",{className:"text-sm text-yellow-700 dark:text-yellow-300 mt-2",children:e.jsx("strong",{children:"أنواع النسخ الاحتياطية:"})}),e.jsxs("ul",{className:"text-sm text-yellow-700 dark:text-yellow-300 mt-1 mr-4",children:[e.jsxs("li",{children:["• ",e.jsx("strong",{children:"نسخة عادية (.db):"})," قاعدة البيانات فقط - سريعة وحجم صغير"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"نسخة مع صور (.zip):"})," قاعدة البيانات + جميع الصور - حماية شاملة"]})]})]})]})})]})]}),!1,e.jsxs("div",{className:"bg-card dark:bg-gray-800 rounded-xl shadow-sm border border-border dark:border-gray-700",children:[e.jsxs("div",{className:"p-4 sm:p-6 border-b border-border dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-foreground dark:text-white",children:"النسخ الاحتياطية المحفوظة"}),e.jsx("p",{className:"text-sm text-muted-foreground dark:text-gray-300 mt-1",children:"قائمة بجميع النسخ الاحتياطية المتاحة - اضغط على أي نسخة لاستعادتها"})]}),e.jsx("div",{className:"p-4 sm:p-6",children:he?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(T,{className:"w-8 h-8 animate-spin mx-auto text-muted-foreground dark:text-gray-400"}),e.jsx("p",{className:"mt-2 text-muted-foreground dark:text-gray-300",children:"جاري التحميل..."})]}):0===ue.length?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(U,{className:"w-12 h-12 mx-auto text-muted-foreground dark:text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-foreground dark:text-white",children:"لا توجد نسخ احتياطية"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground dark:text-gray-300",children:"ابدأ بإنشاء أول نسخة احتياطية"})]}):e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto scrollbar-thin scrollbar-thumb-border scrollbar-track-transparent",children:ue.map((r,s)=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between p-4 border border-border dark:border-gray-700 rounded-lg hover:bg-accent/50 dark:hover:bg-gray-700/50 cursor-pointer transition-all duration-200 group",onClick:()=>hr(r.path),children:[e.jsxs("div",{className:"flex items-start space-x-3 space-x-reverse w-full",children:[e.jsx("div",{className:"p-2 bg-primary/10 dark:bg-blue-500/20 rounded-lg flex-shrink-0",children:e.jsx(i,{className:"w-5 h-5 text-primary dark:text-blue-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:[e.jsx("h4",{className:"text-sm font-medium text-foreground dark:text-white break-words",children:r.name}),r.isSqliteOnly&&e.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 dark:bg-blue-500/20 text-blue-800 dark:text-blue-400 rounded-full whitespace-nowrap",children:"SQLite"}),r.includesImages&&e.jsxs("span",{className:"px-2 py-1 text-xs bg-green-100 dark:bg-green-500/20 text-green-800 dark:text-green-400 rounded-full flex items-center gap-1 whitespace-nowrap",children:[e.jsx(Se,{className:"w-3 h-3"}),"مع صور"]}),r.isLegacy&&e.jsx("span",{className:"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-500/20 text-gray-800 dark:text-gray-400 rounded-full whitespace-nowrap",children:"قديم"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-muted-foreground dark:text-gray-300",children:[e.jsx("span",{className:"whitespace-nowrap",children:Ve(r.created_at)}),e.jsx("span",{className:"whitespace-nowrap",children:Ue(r.size)}),r.version&&e.jsxs("span",{className:"whitespace-nowrap",children:["إصدار ",r.version]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse mt-3 sm:mt-0 flex-shrink-0 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:[e.jsx("button",{onClick:e=>{e.stopPropagation(),hr(r.path)},className:"p-2 text-green-600 dark:text-green-400 hover:bg-green-100 dark:hover:bg-green-500/20 rounded-lg transition-all duration-300 ease-in-out interactive-card min-h-[44px] min-w-[44px] flex items-center justify-center hover:scale-110 active:scale-95 hover:shadow-md",title:"استعادة","aria-label":"استعادة النسخة الاحتياطية",children:e.jsx(je,{className:"w-4 h-4"})}),e.jsx("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),l(r.name)},className:"p-2 text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-500/20 rounded-lg transition-all duration-300 ease-in-out interactive-card min-h-[44px] min-w-[44px] flex items-center justify-center hover:scale-110 active:scale-95 hover:shadow-md",title:"حذف",type:"button","aria-label":"حذف النسخة الاحتياطية",children:e.jsx(ve,{className:"w-4 h-4"})})]})]},`${r.name}-${s}`))})})]})]}),"diagnostics"===a&&e.jsx("div",{className:"w-full h-full flex flex-col min-h-0",children:e.jsxs("div",{className:"bg-card dark:bg-gray-800 rounded-xl shadow-sm border border-border dark:border-gray-700 flex-1 flex flex-col min-h-0",children:[e.jsxs("div",{className:"p-4 sm:p-6 border-b border-border dark:border-gray-700 flex-shrink-0",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-foreground dark:text-white",children:"تشخيص النظام"}),e.jsx("p",{className:"text-sm text-muted-foreground dark:text-gray-300 mt-1",children:"فحص حالة قاعدة البيانات والنظام"})]}),e.jsx("div",{className:"p-4 sm:p-6 flex-1 overflow-auto min-h-0",children:e.jsx(ze,{})})]})}),"appearance"===a&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-card dark:bg-slate-800 rounded-xl shadow-sm border border-border dark:border-slate-600",children:[e.jsxs("div",{className:"p-4 sm:p-6 border-b border-border dark:border-slate-600",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-foreground dark:text-slate-100",children:"إعدادات المظهر"}),e.jsx("p",{className:"text-sm text-muted-foreground dark:text-slate-300 mt-1",children:"تخصيص مظهر التطبيق وفقاً لتفضيلاتك"})]}),e.jsxs("div",{className:"p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start sm:items-center justify-between gap-3 flex-col sm:flex-row",children:[e.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:Ze?e.jsx(Y,{className:"w-5 h-5 text-primary"}):e.jsx(J,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground dark:text-slate-100",children:"الوضع المظلم"}),e.jsx("p",{className:"text-sm text-muted-foreground dark:text-slate-300",children:"تبديل بين الوضع الفاتح والمظلم للتطبيق"})]})]}),e.jsx("button",{onClick:Ye,className:`pr-7 relative inline-flex h-6 w-12 items-center rounded-full transition-all duration-300 ${Ze?"bg-primary":"bg-blue-500"} interactive-card focus:ring-2 focus:ring-primary/50 focus:ring-offset-2`,"aria-label":Ze?"تفعيل الوضع الفاتح":"تفعيل الوضع المظلم",children:e.jsx("span",{className:"inline-block h-4 w-4 transform rounded-full bg-background transition-all duration-300 shadow-sm "+(Ze?"translate-x-1":"translate-x-6")})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-foreground dark:text-white",children:"معاينة المظهر"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"p-4 border border-border rounded-lg bg-background",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h5",{className:"text-sm font-medium text-foreground dark:text-white",children:Ze?"الوضع المظلم":"الوضع الفاتح"}),e.jsx("div",{className:"w-3 h-3 rounded-full bg-primary"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-2 bg-muted rounded"}),e.jsx("div",{className:"h-2 bg-muted rounded w-3/4"}),e.jsx("div",{className:"h-2 bg-muted rounded w-1/2"})]}),e.jsxs("div",{className:"flex space-x-2 space-x-reverse",children:[e.jsx("div",{className:"w-8 h-6 bg-primary rounded text-xs"}),e.jsx("div",{className:"w-8 h-6 bg-secondary rounded text-xs"})]})]})}),e.jsxs("div",{className:"p-4 border border-border dark:border-gray-700 rounded-lg bg-muted/50 dark:bg-gray-700/50",children:[e.jsx("h5",{className:"text-sm font-medium text-foreground dark:text-white mb-2",children:"مميزات المظهر"}),e.jsxs("ul",{className:"text-sm text-muted-foreground dark:text-gray-300 space-y-1",children:[e.jsx("li",{children:"• تحسين قراءة النصوص العربية"}),e.jsx("li",{children:"• ألوان مناسبة للتطبيقات الطبية"}),e.jsx("li",{children:"• حفظ تلقائي للتفضيلات"}),e.jsx("li",{children:"• تباين عالي للوضوح"})]})]})]})]})]})]})}),"whatsapp"===a&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-card dark:bg-gray-800 rounded-xl shadow-sm border border-border dark:border-gray-700",children:[e.jsxs("div",{className:"p-4 sm:p-6 border-b border-border dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-foreground dark:text-white",children:"إعدادات تذكير واتساب"}),e.jsx("p",{className:"text-sm text-muted-foreground dark:text-gray-300 mt-1",children:"إعدادات إرسال التذكيرات عبر واتساب قبل المواعيد"})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start sm:items-center justify-between gap-3 flex-col sm:flex-row",children:[e.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse",children:[e.jsx("div",{className:"p-2 bg-primary/10 dark:bg-blue-500/20 rounded-lg",children:e.jsx(ke,{className:"w-5 h-5 text-primary dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground dark:text-white",children:"تفعيل التذكير"}),e.jsx("p",{className:"text-sm text-muted-foreground dark:text-gray-300",children:"إرسال تذكيرات واتساب تلقائياً قبل المواعيد"})]})]}),e.jsx(we,{checked:m,onCheckedChange:e=>x(e)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"minutesBefore",className:"text-sm font-medium text-foreground",children:"عدد الدقائق قبل الموعد"}),e.jsx("input",{type:"number",id:"minutesBefore",min:"0",max:"10080",value:g,onChange:e=>b(Number(e.target.value)),className:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-xl focus:outline-none focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 dark:focus:border-blue-400 transition-all duration-300 ease-in-out hover:border-blue-400 dark:hover:border-blue-500 hover:shadow-md shadow-sm"}),e.jsx("div",{className:"flex flex-wrap gap-3 mt-4 justify-start",children:[15,30,60,120,180,720,1440].map(r=>e.jsx("button",{type:"button",onClick:()=>b(r),className:"px-4 py-2 text-sm font-medium rounded-full border-2 transition-all duration-300 ease-in-out transform hover:scale-105 active:scale-95 "+(g===r?"bg-blue-600 dark:bg-blue-600 text-white border-blue-600 dark:border-blue-600 shadow-lg shadow-blue-500/25":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 hover:border-blue-400 dark:hover:border-blue-500 hover:text-blue-700 dark:hover:text-blue-300"),children:r>=60?r/60+" ساعة":`${r} دقيقة`},r))})]}),e.jsxs("div",{className:"flex items-start sm:items-center justify-between gap-3 flex-col sm:flex-row",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground",children:"تخصيص نص الرسالة"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"تفعيل هذا الخيار للسماح بكتابة رسالة تذكير مخصصة. إذا كان معطلاً، سيتم استخدام رسالة موحدة."})]}),e.jsx(we,{checked:w,onCheckedChange:e=>y(e)})]}),w&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"messageText",className:"text-sm font-medium text-foreground",children:"نص الرسالة المخصصة"}),e.jsx("textarea",{id:"messageText",rows:4,value:p,onChange:e=>f(e.target.value),placeholder:"مرحبًا {{patient_name}}، تذكير بموعدك في عيادة الأسنان بتاريخ {{appointment_date}} الساعة {{appointment_time}}. نشكرك على التزامك.",className:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-xl focus:outline-none focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 dark:focus:border-blue-400 transition-all duration-300 ease-in-out hover:border-blue-400 dark:hover:border-blue-500 hover:shadow-md shadow-sm",ref:ie}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["يمكنك استخدام متغيرات مثل: اسم المريض (","{{patient_name}}",")، تاريخ الموعد (","{{appointment_date}}",")، وقت الموعد (","{{appointment_time}}",")"]}),e.jsxs("div",{className:"flex flex-wrap gap-3 justify-start",children:[e.jsx("button",{type:"button",onClick:()=>xr("{{patient_name}}"),className:"px-4 py-2 text-sm font-medium bg-green-100 dark:bg-green-900/20 text-green-700 dark:text-green-300 border-2 border-green-200 dark:border-green-700 rounded-full hover:bg-green-200 dark:hover:bg-green-900/30 hover:border-green-300 dark:hover:border-green-600 transition-all duration-300 ease-in-out transform hover:scale-105 active:scale-95 hover:shadow-md shadow-green-500/10",title:"إدراج اسم المريض",children:"اسم المريض"}),e.jsx("button",{type:"button",onClick:()=>xr("{{appointment_date}}"),className:"px-4 py-2 text-sm font-medium bg-blue-100 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 border-2 border-blue-200 dark:border-blue-700 rounded-full hover:bg-blue-200 dark:hover:bg-blue-900/30 hover:border-blue-300 dark:hover:border-blue-600 transition-all duration-300 ease-in-out transform hover:scale-105 active:scale-95 hover:shadow-md shadow-blue-500/10",title:"إدراج تاريخ الموعد",children:"تاريخ الموعد"}),e.jsx("button",{type:"button",onClick:()=>xr("{{appointment_time}}"),className:"px-4 py-2 text-sm font-medium bg-purple-100 dark:bg-purple-900/20 text-purple-700 dark:text-purple-300 border-2 border-purple-200 dark:border-purple-700 rounded-full hover:bg-purple-200 dark:hover:bg-purple-900/30 hover:border-purple-300 dark:hover:border-purple-600 transition-all duration-300 ease-in-out transform hover:scale-105 active:scale-95 hover:shadow-md shadow-purple-500/10",title:"إدراج وقت الموعد",children:"وقت الموعد"})]})]}),e.jsxs("div",{className:"bg-card dark:bg-gray-800 rounded-xl shadow-sm border border-border dark:border-gray-700 mt-6",children:[e.jsxs("div",{className:"p-4 sm:p-6 border-b border-border dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-foreground dark:text-white",children:"إدارة اتصال واتساب"}),e.jsx("p",{className:"text-sm text-muted-foreground dark:text-gray-300 mt-1",children:"إدارة حالة اتصال التطبيق مع واتساب."})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{className:"p-4 border-2 border-primary/20 dark:border-blue-500/20 rounded-lg bg-primary/5 dark:bg-blue-500/10",children:e.jsxs("div",{className:"flex items-start md:items-center justify-between gap-4 flex-col md:flex-row",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-base font-semibold text-foreground dark:text-white mb-2 block",children:"🔗 ربط عبر رمز QR"}),e.jsx("p",{className:"text-sm text-muted-foreground dark:text-gray-300",children:"ربط حساب واتساب الخاص بك عبر رمز QR لتفعيل التذكيرات."}),e.jsx("p",{className:"text-xs text-muted-foreground dark:text-gray-400 mt-2",children:"اضغط لعرض رمز QR ومسحه بتطبيق واتساب على هاتفك. سيتم إعادة تهيئة الجلسة تلقائياً."})]}),e.jsxs("button",{onClick:async()=>{try{Q(""),_(!0);try{console.log("🔍 Debug: Checking electronAPI availability:",{hasElectronAPI:!!window.electronAPI,hasWhatsappReminders:!!window.electronAPI?.whatsappReminders,hasGenerateNewQR:!!window.electronAPI?.whatsappReminders?.generateNewQR,generateNewQRType:typeof window.electronAPI?.whatsappReminders?.generateNewQR});const r=window.electronAPI?.whatsappReminders?.generateNewQR;if(!r)return console.error("❌ generateNewQR function not available"),void mr("خدمة توليد رمز QR غير متاحة","error");let s;try{s=await r()}catch(e){throw console.error("❌ IPC call failed:",e),console.error("❌ IPC error details:",{message:e?.message,stack:e?.stack,type:e?.constructor?.name}),e}if(s?.success){mr("تم بدء عملية توليد رمز QR جديد","info");let e=0;const r=10,s=async()=>{e++;try{const a=await(window.electronAPI?.whatsappReminders?.getStatus?.());if(a?.qr&&""!==a.qr.trim())return Q(a.qr),void mr("تم توليد رمز QR بنجاح!","success");e<r?setTimeout(s,1e3):mr("لم يتم توليد رمز QR. يرجى المحاولة مرة أخرى.","error")}catch(a){console.warn("Failed to check status after QR generation:",a),e<r?setTimeout(s,1e3):mr("تعذر التحقق من حالة رمز QR","error")}};setTimeout(s,1500)}else{console.warn("⚠️ QR generation failed:",s?.error||"Unknown error");const e=s?.details;let r="فشل في توليد رمز QR";s?.error&&"Unknown error"!==s.error?r+=`: ${s.error}`:e?(r+=`: ${e.type}`,"N/A"!==e.code&&(r+=` (${e.code})`)):r+=": خطأ غير معروف",mr(r,"error"),e&&console.error("📊 Detailed error info:",{type:e.type,code:e.code,stack:e.stack}),console.error("📊 Full generateResult object:",s)}}catch(r){console.error("❌ QR generation failed:",r),mr(`تعذر توليد رمز QR: ${r?.message||"خطأ غير معروف"}`,"error")}mr("تم طلب رمز QR جديد. امسح الرمز على هاتفك.","info")}catch(s){console.error("❌ Failed to start QR flow:",s),mr("تعذر بدء عملية الربط عبر QR","error")}},className:"px-8 py-4 bg-gradient-to-r from-green-500 to-green-600 dark:from-green-600 dark:to-green-700 text-white rounded-2xl hover:from-green-600 hover:to-green-700 dark:hover:from-green-700 dark:hover:to-green-800 transition-all duration-300 ease-in-out flex items-center justify-center space-x-3 space-x-reverse font-semibold shadow-xl hover:shadow-2xl focus:ring-4 focus:ring-green-500/30 focus:ring-offset-2 w-full md:w-auto hover:scale-105 active:scale-95 transform",children:[e.jsx(ke,{className:"w-5 h-5"}),e.jsx("span",{children:"ربط عبر QR"})]})]})}),e.jsxs("div",{className:"flex items-start sm:items-center justify-between gap-3 p-4 border border-border dark:border-gray-700 rounded-lg bg-muted/30 dark:bg-gray-700/50 flex-col sm:flex-row",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground dark:text-white",children:"إعادة تهيئة اتصال واتساب"}),e.jsx("p",{className:"text-xs text-muted-foreground dark:text-gray-300 mt-1",children:"حذف الجلسة الحالية لإظهار رمز QR من جديد وإعادة الربط."})]}),e.jsx("button",{onClick:()=>$(!0),className:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 dark:from-red-600 dark:to-red-700 text-white rounded-xl hover:from-red-600 hover:to-red-700 dark:hover:from-red-700 dark:hover:to-red-800 transition-all duration-300 ease-in-out w-full sm:w-auto hover:scale-105 active:scale-95 hover:shadow-xl shadow-red-500/20 focus:ring-4 focus:ring-red-500/30 focus:ring-offset-2 transform font-medium",children:"حذف جلسة الربط (QR)"})]})]})]})]})]})}),"shortcuts"===a&&e.jsxs("div",{className:"w-full h-full flex flex-col min-h-0",children:[e.jsx("div",{className:"bg-card dark:bg-gray-800 rounded-xl shadow-sm border border-border dark:border-gray-700 flex-1 flex flex-col min-h-0",children:e.jsx("div",{className:"p-6 sm:p-8 flex-1 overflow-auto",children:e.jsx(Te,{})})}),e.jsxs("div",{className:"bg-card dark:bg-gray-800 rounded-xl shadow-sm border border-border dark:border-gray-700",children:[e.jsx("div",{className:"p-4 sm:p-6 border-b border-border dark:border-gray-700",children:e.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-foreground dark:text-white",children:"نصائح للاستخدام"})}),e.jsx("div",{className:"p-6 space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-950/20 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-800 dark:text-blue-200 mb-2",children:"الأحرف العربية"}),e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:"يمكنك استخدام الأحرف العربية أو الإنجليزية للاختصارات. مثلاً: A أو ش لإضافة مريض جديد."})]}),e.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-950/20 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-green-800 dark:text-green-200 mb-2",children:"التنقل السريع"}),e.jsx("p",{className:"text-sm text-green-700 dark:text-green-300",children:"استخدم الأرقام 0-9 أو ٠-٩ للتنقل السريع بين الصفحات المختلفة."})]}),e.jsxs("div",{className:"p-4 bg-purple-50 dark:bg-purple-950/20 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-purple-800 dark:text-purple-200 mb-2",children:"الإجراءات السريعة"}),e.jsx("p",{className:"text-sm text-purple-700 dark:text-purple-300",children:"استخدم A/S/D أو ش/س/ي لإضافة مريض أو موعد أو دفعة بسرعة."})]}),e.jsxs("div",{className:"p-4 bg-orange-50 dark:bg-orange-950/20 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-orange-800 dark:text-orange-200 mb-2",children:"العمليات العامة"}),e.jsx("p",{className:"text-sm text-orange-700 dark:text-orange-300",children:"F1 للإعدادات، R/ق للتحديث، F/ب للبحث، ESC للإغلاق."})]})]})})]})]}),e.jsx(ee,{open:q,onOpenChange:L,children:e.jsxs(re,{dir:"rtl",children:[e.jsxs(se,{children:[e.jsxs(ae,{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"w-5 h-5 text-destructive"}),"تأكيد حذف جلسة واتساب"]}),e.jsxs(te,{children:["هل أنت متأكد من حذف جلسة الربط الحالية؟ سيتم عرض رمز QR من جديد لإعادة الربط.",e.jsx("br",{}),e.jsx("strong",{className:"text-destructive",children:"تحذير: لا يمكن التراجع عن هذا الإجراء!"})]})]}),e.jsxs(oe,{className:"flex-row-reverse",children:[e.jsxs(le,{className:"bg-destructive hover:bg-destructive/90",onClick:async()=>{try{const e=await(window.electronAPI?.whatsappReminders?.resetSession?.());e?.success?mr("تم حذف الجلسة بنجاح. سيظهر رمز QR لإعادة الربط.","success"):mr(e?.error||"فشل في حذف الجلسة","error")}catch(e){console.error("Error resetting WhatsApp session:",e),mr("حدث خطأ أثناء حذف الجلسة","error")}},children:[e.jsx(ve,{className:"w-4 h-4 ml-2"}),"تأكيد الحذف"]}),e.jsx(de,{className:"transition-all duration-200 interactive-card",children:"إلغاء"})]})]})}),e.jsx(ee,{open:z,onOpenChange:$,children:e.jsxs(re,{dir:"rtl",children:[e.jsxs(se,{children:[e.jsxs(ae,{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"w-5 h-5 text-destructive"}),"تأكيد حذف جلسة واتساب"]}),e.jsxs(te,{children:["هل أنت متأكد من حذف جلسة الربط الحالية؟ سيتم عرض رمز QR من جديد لإعادة الربط.",e.jsx("br",{}),e.jsx("strong",{className:"text-destructive",children:"تحذير: لا يمكن التراجع عن هذا الإجراء!"})]})]}),e.jsxs(oe,{className:"flex-row-reverse",children:[e.jsxs(le,{className:"bg-destructive hover:bg-destructive/90",onClick:async()=>{try{const e=await(window.electronAPI?.whatsappReminders?.resetSession?.());e?.success?mr("تمت إعادة تهيئة جلسة واتساب بنجاح. قد تحتاج لإعادة ربط الحساب.","success"):mr(e?.error||"فشل في إعادة تهيئة الجلسة","error")}catch(e){console.error("Failed to reset WhatsApp session:",e),mr("حدث خطأ أثناء إعادة التهيئة","error")}finally{$(!1)}},children:[e.jsx(ve,{className:"w-4 h-4 ml-2"}),"تأكيد الحذف"]}),e.jsx(de,{className:"transition-all duration-200 interactive-card",children:"إلغاء"})]})]})}),"security"===a&&e.jsx(Be,{showNotification:mr}),"clinic"===a&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-card dark:bg-gray-800 rounded-xl shadow-sm border border-border dark:border-gray-700",children:[e.jsxs("div",{className:"p-4 sm:p-6 border-b border-border dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-foreground dark:text-white",children:"معلومات العيادة"}),e.jsx("p",{className:"text-sm text-muted-foreground dark:text-gray-300 mt-1",children:"إعدادات العيادة الأساسية والمعلومات التي تظهر في الإيصالات"})]}),e.jsx("div",{className:"p-6",children:e.jsxs("form",{className:"space-y-6",onSubmit:e=>{e.preventDefault();const r=new FormData(e.currentTarget),s={clinic_name:r.get("clinic_name"),doctor_name:r.get("doctor_name"),clinic_address:r.get("clinic_address"),clinic_phone:r.get("clinic_phone"),clinic_email:r.get("clinic_email"),currency:r.get("currency")};gr(s)},children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"clinic_name",className:"text-sm font-medium text-foreground",children:"اسم العيادة *"}),e.jsx("input",{type:"text",id:"clinic_name",name:"clinic_name",defaultValue:Ge?.clinic_name||"",className:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-xl focus:outline-none focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 dark:focus:border-blue-400 transition-all duration-300 ease-in-out hover:border-blue-400 dark:hover:border-blue-500 hover:shadow-md shadow-sm",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"doctor_name",className:"text-sm font-medium text-foreground",children:"اسم الدكتور *"}),e.jsx("input",{type:"text",id:"doctor_name",name:"doctor_name",defaultValue:Ge?.doctor_name||"",placeholder:"د. محمد أحمد",className:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-xl focus:outline-none focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 dark:focus:border-blue-400 transition-all duration-300 ease-in-out hover:border-blue-400 dark:hover:border-blue-500 hover:shadow-md shadow-sm",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"clinic_phone",className:"text-sm font-medium text-foreground",children:"رقم الهاتف"}),e.jsx("input",{type:"tel",id:"clinic_phone",name:"clinic_phone",placeholder:"96395 XXX XXXX",defaultValue:Ge?.clinic_phone||"",className:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-xl focus:outline-none focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 dark:focus:border-blue-400 transition-all duration-300 ease-in-out hover:border-blue-400 dark:hover:border-blue-500 hover:shadow-md shadow-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"clinic_email",className:"text-sm font-medium text-foreground",children:"البريد الإلكتروني"}),e.jsx("input",{type:"email",id:"clinic_email",name:"clinic_email",defaultValue:Ge?.clinic_email||"",placeholder:"clinic@example.com",className:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-xl focus:outline-none focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 dark:focus:border-blue-400 transition-all duration-300 ease-in-out hover:border-blue-400 dark:hover:border-blue-500 hover:shadow-md shadow-sm"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"clinic_address",className:"text-sm font-medium text-foreground",children:"عنوان العيادة"}),e.jsx("textarea",{id:"clinic_address",name:"clinic_address",defaultValue:Ge?.clinic_address||"",placeholder:"حلب، الجمهورية العربية السورية",rows:3,className:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-xl focus:outline-none focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 dark:focus:border-blue-400 transition-all duration-300 ease-in-out hover:border-blue-400 dark:hover:border-blue-500 hover:shadow-md shadow-sm resize-none"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"currency",className:"text-sm font-medium text-foreground flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4"}),"العملة المستخدمة"]}),e.jsx("select",{id:"currency",name:"currency",defaultValue:Ge?.currency||Je||"USD",className:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-xl focus:outline-none focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 dark:focus:border-blue-400 transition-all duration-300 ease-in-out hover:border-blue-400 dark:hover:border-blue-500 hover:shadow-md shadow-sm",onChange:e=>{er(e.target.value)},children:Object.entries(ne).filter(([e])=>"USD"===e||"SYP"===e).map(([r,s])=>e.jsxs("option",{value:r,children:[s.nameAr," (",s.symbol,") - ",s.name]},r))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"العملة المختارة ستظهر في جميع أنحاء التطبيق (المدفوعات، التقارير، الإحصائيات)"})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t border-border",children:[e.jsx("h4",{className:"text-sm font-medium text-foreground",children:"شعار العيادة"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-20 h-20 border-2 border-dashed border-border rounded-lg flex items-center justify-center bg-muted/50",children:ar?e.jsx("img",{src:ar,alt:"شعار العيادة",className:"w-full h-full object-cover rounded-lg"}):e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 mx-auto mb-1 text-muted-foreground",children:"📷"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"لا يوجد شعار"})]})})}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2",children:[e.jsx("input",{type:"file",id:"clinic_logo",accept:"image/png,image/jpeg,image/jpg,image/svg+xml",className:"hidden",onChange:async e=>{const r=e.target.files?.[0];if(!r)return;nr("");if(r.size>5242880)return void nr("حجم الملف كبير جداً. الحد الأقصى المسموح به هو 5 ميجابايت.");if(["image/png","image/jpeg","image/jpg","image/svg+xml"].includes(r.type)){lr(!0);try{const e=new FileReader;e.onload=async e=>{const r=e.target?.result;try{await gr({clinic_logo:r}),mr("تم تحديث شعار العيادة بنجاح","success")}catch(s){console.error("Error updating logo:",s),nr("فشل في حفظ الشعار. يرجى المحاولة مرة أخرى.")}finally{lr(!1)}},e.onerror=()=>{nr("فشل في قراءة الملف. يرجى المحاولة مرة أخرى."),lr(!1)},e.readAsDataURL(r)}catch(s){console.error("Error processing file:",s),nr("حدث خطأ أثناء معالجة الملف."),lr(!1)}}else nr("نوع الملف غير مدعوم. الصيغ المسموحة: PNG, JPG, SVG فقط.")}}),e.jsx("button",{type:"button",onClick:()=>document.getElementById("clinic_logo")?.click(),disabled:or,className:"px-3 py-2 text-sm border border-input bg-background text-foreground rounded-md hover:bg-accent disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 ease-in-out interactive-card w-full sm:w-auto hover:scale-105 active:scale-95 hover:shadow-md",children:or?"جاري الرفع...":"اختيار شعار"}),ar&&e.jsx("button",{type:"button",onClick:()=>gr({clinic_logo:""}),disabled:or,className:"px-3 py-2 text-sm border border-red-200 bg-red-50 text-red-700 rounded-md hover:bg-red-100 disabled:opacity-50 transition-all duration-300 ease-in-out interactive-card w-full sm:w-auto hover:scale-105 active:scale-95 hover:shadow-md",children:"حذف الشعار"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"يُفضل استخدام صورة مربعة بحجم 200x200 بكسل أو أكبر. الحد الأقصى لحجم الملف: 5 ميجابايت. الصيغ المدعومة: PNG, JPG, SVG"}),dr&&e.jsx("div",{className:"text-xs text-red-600 bg-red-50 dark:bg-red-900/20 p-2 rounded-md border border-red-200 dark:border-red-800",children:dr})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:he,className:"px-8 py-4 bg-gradient-to-r from-blue-500 to-blue-600 dark:from-blue-600 dark:to-blue-700 text-white rounded-2xl hover:from-blue-600 hover:to-blue-700 dark:hover:from-blue-700 dark:hover:to-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 ease-in-out focus:ring-4 focus:ring-blue-500/30 focus:ring-offset-2 hover:scale-105 active:scale-95 hover:shadow-2xl shadow-xl transform font-semibold",children:he?"جاري الحفظ...":"حفظ الإعدادات"})})]})})]})}),"development"===a&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-card dark:bg-gray-800 rounded-xl shadow-sm border border-border dark:border-gray-700",children:[e.jsxs("div",{className:"p-4 sm:p-6 border-b border-border dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-foreground dark:text-white",children:"معلومات فريق التطوير"}),e.jsx("p",{className:"text-sm text-muted-foreground dark:text-gray-300 mt-1",children:"تواصل مع فريق التطوير للدعم الفني والاستفسارات"})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4 space-x-reverse p-4 bg-muted/50 dark:bg-gray-700/50 rounded-lg",children:[e.jsx("div",{className:"p-3 bg-primary/10 dark:bg-blue-500/20 rounded-lg",children:e.jsx(xe,{className:"w-6 h-6 text-primary dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-foreground dark:text-white",children:"اسم الفريق"}),e.jsx("p",{className:"text-lg font-bold text-foreground dark:text-white",children:"ORalSoft"}),e.jsx("p",{className:"text-sm text-muted-foreground dark:text-gray-300",children:"فريق تطوير تطبيقات إدارة العيادات"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-x-4 space-x-reverse p-4 bg-muted/50 dark:bg-gray-700/50 rounded-lg gap-4",children:[e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/20 rounded-lg flex-shrink-0",children:e.jsx(ke,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-foreground dark:text-white",children:"رقم التواصل"}),e.jsx("p",{className:"text-lg font-bold text-foreground dark:text-white",children:"00963938352132"}),e.jsx("p",{className:"text-sm text-muted-foreground dark:text-gray-300",children:"متاح للدعم الفني من 9 صباحاً إلى 6 مساءً"})]}),e.jsx("button",{onClick:async()=>{const e="https://api.whatsapp.com/send/?phone=963938352132";try{if(window.electronAPI&&window.electronAPI.system&&window.electronAPI.system.openExternal)return void(await window.electronAPI.system.openExternal(e))}catch(r){console.log("Method 1 failed:",r)}try{if(window.electronAPI)return void(await(window.electronAPI.shell?.openExternal?.(e)))}catch(r){console.log("Method 2 failed:",r)}window.open(e,"_blank","noopener,noreferrer")},className:"px-4 py-2 bg-green-600 dark:bg-green-600 text-white rounded-lg hover:bg-green-700 dark:hover:bg-green-700 transition-all duration-300 ease-in-out interactive-card w-full sm:w-auto hover:scale-105 active:scale-95 hover:shadow-lg dark:hover:shadow-green-500/25",children:"تواصل عبر واتساب"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-x-4 space-x-reverse p-4 bg-muted/50 dark:bg-gray-700/50 rounded-lg gap-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/20 rounded-lg flex-shrink-0",children:e.jsx(Ce,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-foreground dark:text-white",children:"البريد الإلكتروني"}),e.jsx("p",{className:"text-lg font-bold text-foreground dark:text-white",children:"ORalSoft24@gmail.com"}),e.jsx("p",{className:"text-sm text-muted-foreground dark:text-gray-300",children:"للاستفسارات والدعم الفني"})]}),e.jsx("button",{onClick:()=>window.open("mailto:ORalSoft24@gmail.com البريد","_blank"),className:"px-4 py-2 bg-blue-600 dark:bg-blue-600 text-white rounded-lg hover:bg-blue-700 dark:hover:bg-blue-700 transition-all duration-300 ease-in-out interactive-card w-full sm:w-auto hover:scale-105 active:scale-95 hover:shadow-lg dark:hover:shadow-blue-500/25",children:"إرسال إيميل"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-x-4 space-x-reverse p-4 bg-muted/50 dark:bg-gray-700/50 rounded-lg gap-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/20 rounded-lg flex-shrink-0",children:e.jsx(Re,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-foreground dark:text-white",children:"صفحة الفيسبوك"}),e.jsx("p",{className:"text-lg font-bold text-foreground dark:text-white",children:"ORalSoft"}),e.jsx("p",{className:"text-sm text-muted-foreground dark:text-gray-300",children:"تابعنا للحصول على آخر التحديثات والأخبار"})]}),e.jsx("button",{onClick:()=>{const e="https://www.facebook.com/people/ORalSoft/100082266005063/?rdid=kZwmucsShbQVaBdv&share_url=https%253A%252F%252Fwww.facebook.com%252Fshare%252F1EhsuXSbaZ%252F";try{if(window.electronAPI&&window.electronAPI.system&&window.electronAPI.system.openExternal)return void window.electronAPI.system.openExternal(e)}catch(r){console.log("Method 1 failed:",r)}try{if(window.electronAPI)return void window.electronAPI.shell?.openExternal?.(e)}catch(r){console.log("Method 2 failed:",r)}window.open(e,"_blank","noopener,noreferrer")},className:"px-4 py-2 bg-blue-600 dark:bg-blue-600 text-white rounded-lg hover:bg-blue-700 dark:hover:bg-blue-700 transition-all duration-300 ease-in-out interactive-card w-full sm:w-auto hover:scale-105 active:scale-95 hover:shadow-lg dark:hover:shadow-blue-500/25",children:"زيارة الصفحة"})]}),e.jsx("div",{className:"p-4 bg-primary/5 dark:bg-blue-500/10 border border-primary/20 dark:border-blue-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3 space-x-reverse",children:[e.jsx("div",{className:"p-2 bg-primary/10 dark:bg-blue-500/20 rounded-lg",children:e.jsx(c,{className:"w-5 h-5 text-primary dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-foreground dark:text-white mb-2",children:"معلومات إضافية"}),e.jsxs("ul",{className:"text-sm text-muted-foreground dark:text-gray-300 space-y-1",children:[e.jsx("li",{children:"• نقدم دعماً فنياً شاملاً لجميع مستخدمي التطبيق"}),e.jsx("li",{children:"• نستقبل اقتراحاتكم لتطوير وتحسين التطبيق"}),e.jsx("li",{children:"• نوفر تدريباً مجانياً على استخدام التطبيق"}),e.jsx("li",{children:"• نضمن الاستجابة السريعة لجميع الاستفسارات"})]})]})]})})]})]})}),o&&e.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",style:{zIndex:9999},children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>l(null),style:{zIndex:9998}}),e.jsx("div",{className:"relative bg-card border border-border rounded-lg shadow-2xl max-w-md w-full mx-4",style:{zIndex:1e4},dir:"rtl",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-red-100 dark:bg-red-900/20 rounded-full flex items-center justify-center ml-3",children:e.jsx(A,{className:"w-5 h-5 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"تأكيد الحذف"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"هل أنت متأكد من حذف هذه النسخة الاحتياطية؟"})]})]}),e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex",children:[e.jsx(A,{className:"w-4 h-4 text-red-600 dark:text-red-400 ml-2 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-red-800 dark:text-red-200 font-medium",children:"تحذير: لا يمكن التراجع عن هذا الإجراء"}),e.jsxs("p",{className:"text-sm text-red-700 dark:text-red-300 mt-1",children:['سيتم حذف النسخة الاحتياطية "',o,'" نهائياً من النظام.']})]})]})}),e.jsxs("div",{className:"flex justify-end space-x-3 space-x-reverse",children:[e.jsx("button",{onClick:()=>l(null),className:"px-4 py-2 border border-input bg-background text-foreground rounded-lg hover:bg-accent transition-all duration-300 ease-in-out interactive-card hover:scale-105 active:scale-95 hover:shadow-md",children:"إلغاء"}),e.jsx("button",{onClick:()=>(async e=>{try{await De(e),mr("تم حذف النسخة الاحتياطية بنجاح","success"),l(null)}catch(r){console.error("❌ Failed to delete backup:",r),mr(`فشل في حذف النسخة الاحتياطية: ${r instanceof Error?r.message:"خطأ غير معروف"}`,"error"),l(null)}})(o),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-all duration-300 ease-in-out interactive-card focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 hover:scale-105 active:scale-95 hover:shadow-lg dark:hover:shadow-red-500/25",children:"تأكيد الحذف"})]})]})})]}),P&&e.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>_(!1)}),e.jsx("div",{className:"relative bg-card/95 border border-border rounded-2xl shadow-2xl max-w-2xl w-full mx-4",dir:"rtl",children:e.jsxs("div",{className:"p-6 sm:p-8 space-y-5",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-foreground",children:"ربط واتساب عبر رمز QR"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"افتح واتساب على هاتفك → الإعدادات → الأجهزة المرتبطة → ربط جهاز."})]}),e.jsx("button",{onClick:()=>_(!1),className:"px-2 py-1 text-sm text-muted-foreground hover:text-foreground transition-all duration-300 ease-in-out interactive-card rounded-lg hover:scale-110 active:scale-95 hover:bg-gray-100 dark:hover:bg-gray-700",children:"✕"})]}),e.jsx("div",{className:"flex items-center justify-center p-4 bg-white border border-border rounded-xl min-h-[512px]",children:I&&""!==I.trim()?K?e.jsxs("div",{className:"relative",children:[e.jsx("div",{"aria-label":"WhatsApp QR Code",style:{width:512,height:512,lineHeight:0,shapeRendering:"crispEdges"},className:"block rounded-md shadow-xl select-none",dangerouslySetInnerHTML:{__html:K}}),I.length>0&&e.jsx("div",{className:"absolute -bottom-2 -right-2 bg-green-500 text-white text-xs px-2 py-1 rounded-full",children:"✓ صالح"})]}):F?e.jsxs("div",{className:"relative",children:[e.jsx("img",{alt:"WhatsApp QR Code",src:F,width:512,height:512,style:{imageRendering:"pixelated"},className:"block w-[512px] h-[512px] rounded-md shadow-xl select-none",onError:e=>{console.error("❌ QR image failed to load:",e),console.error("Image URL:",F.substring(0,100)+"..."),mr("فشل في تحميل صورة رمز QR","error")},onLoad:()=>{console.log("✅ QR image loaded successfully")}}),I.length>0&&e.jsx("div",{className:"absolute -bottom-2 -right-2 bg-green-500 text-white text-xs px-2 py-1 rounded-full",children:"✓ صالح"})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"جاري توليد رمز QR..."})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-3",children:[e.jsx("div",{className:"w-16 h-16 bg-muted rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-muted-foreground",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})})}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"جاري انتظار رمز QR..."}),e.jsx("div",{className:"text-xs text-muted-foreground",children:'اضغط على "ربط عبر QR" لبدء العملية'})]})}),e.jsxs("ul",{className:"text-xs text-muted-foreground list-disc pr-5 space-y-1",children:[e.jsx("li",{children:"إذا لم يتعرف واتساب على الرمز، اضبط سطوع الشاشة وتجنب الانعكاسات."}),e.jsx("li",{children:"إن لم يظهر الرمز خلال ثوانٍ، اضغط إعادة توليد."})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>_(!1),className:"px-4 py-2 border border-input rounded-lg transition-all duration-300 ease-in-out interactive-card hover:scale-105 active:scale-95 hover:shadow-md",children:"إغلاق"}),e.jsx("button",{onClick:async()=>{try{Q(""),console.log("🔄 Regenerating QR code...");const e=await(window.electronAPI?.whatsappReminders?.generateNewQR?.());if(e?.success){console.log("✅ QR regeneration initiated successfully"),mr("تم بدء عملية إعادة توليد رمز QR","info");let e=0;const r=8,s=async()=>{e++;try{const a=await(window.electronAPI?.whatsappReminders?.getStatus?.());if(a?.qr&&""!==a.qr.trim())return console.log("🔍 New QR found after regeneration attempt",e),Q(a.qr),void mr("تم إعادة توليد رمز QR بنجاح!","success");e<r?(console.log("📱 No QR found, retrying... (attempt",e,"of",r,")"),setTimeout(s,1500)):(console.log("📱 No QR found after",r,"regeneration attempts"),mr("لم يتم إعادة توليد رمز QR. يرجى المحاولة مرة أخرى.","error"))}catch(a){console.warn("Failed to check status after regeneration:",a),e<r?setTimeout(s,1500):mr("تعذر التحقق من حالة رمز QR","error")}};setTimeout(s,2e3)}else{console.warn("⚠️ QR regeneration failed:",e?.error||"Unknown error");const r=e?.details;let s="فشل في إعادة توليد رمز QR";e?.error&&"Unknown error"!==e.error?s+=`: ${e.error}`:r?(s+=`: ${r.type}`,"N/A"!==r.code&&(s+=` (${r.code})`)):s+=": خطأ غير معروف",mr(s,"error"),r&&console.error("📊 Regeneration detailed error info:",{type:r.type,code:r.code,stack:r.stack}),console.error("📊 Full regeneration generateResult object:",e)}}catch(e){console.error("Error regenerating QR:",e),mr(`حدث خطأ أثناء إعادة توليد رمز QR: ${e?.message||"خطأ غير معروف"}`,"error")}},className:"px-4 py-2 bg-primary text-white rounded-lg shadow-sm hover:bg-primary/90 transition-all duration-300 ease-in-out interactive-card hover:scale-105 active:scale-95 hover:shadow-lg dark:hover:shadow-blue-500/25",children:"إعادة توليد QR"})]})]})})]}),d.show&&e.jsx("div",{className:"fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg transition-all duration-300 "+("success"===d.type?"bg-green-500 text-white":"error"===d.type?"bg-red-500 text-white":"bg-blue-500 text-white"),children:e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx("span",{className:"text-lg",children:"success"===d.type?"✅":"error"===d.type?"❌":"ℹ️"}),e.jsx("span",{children:d.message})]})})]})})})}export{$e as default};
