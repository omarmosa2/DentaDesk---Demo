import{j as e}from"./ui-cacc1eea.js";import{r as t}from"./vendor-696af5bd.js";import{aj as s,ag as a,I as r,w as n,ah as l,C as c,l as i,aZ as o,B as m,_ as p,s as u,M as h,U as d}from"./index-3a8dc84c.js";import{u as x}from"./globalStore-4b1adbba.js";import{F as f}from"./file-text-861b9f90.js";import"./pdf-991f41f6.js";import"./utils-ec524415.js";import"./charts-b4389b44.js";
/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g=s("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);function j({onResultSelect:s,onClose:j,autoFocus:y=!0,placeholder:N="ðŸ” Ø§Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ø±Ø¶Ù‰ØŒ Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ØŒ Ø§Ù„Ø¯ÙØ¹Ø§ØªØŒ Ø§Ù„Ø¹Ù„Ø§Ø¬Ø§Øª... (F)"}){const{globalSearchQuery:v,globalSearchResults:w,isSearching:b,searchHistory:S,setGlobalSearchQuery:k,performGlobalSearch:C,clearSearchResults:E,addToSearchHistory:R}=x(),[D,T]=t.useState(!1),[q,z]=t.useState(-1),A=t.useRef(null),F=t.useRef(null),B=t.useRef(null);t.useEffect(()=>{y&&A.current&&A.current.focus()},[y]),t.useEffect(()=>{const e=e=>{B.current&&!B.current.contains(e.target)&&H()};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);t.useEffect(()=>{const e=setTimeout(()=>{v&&(async e=>{if(k(e),e.trim().length>0){const s={query:e.trim(),sortBy:"relevance",sortOrder:"desc",limit:20};try{await C(s),T(!0),z(-1),console.log("ðŸ” Search performed:",e.trim()),console.log("ðŸ” Search results:",w)}catch(t){console.error("Search error:",t),T(!0)}}else T(!1),E()})(v)},300);return()=>clearTimeout(e)},[v]);const G=e=>{R(v),s?.(e),H()},H=()=>{T(!1),E(),k(""),j?.()},L=t=>{switch(t){case"patient":return e.jsx(d,{className:"w-4 h-4 text-blue-500"});case"appointment":return e.jsx(h,{className:"w-4 h-4 text-purple-500"});case"payment":return e.jsx(u,{className:"w-4 h-4 text-green-500"});case"treatment":return e.jsx(p,{className:"w-4 h-4 text-red-500"});case"prescription":return e.jsx(f,{className:"w-4 h-4 text-orange-500"});default:return e.jsx(a,{className:"w-4 h-4 text-gray-500"})}},M=e=>{switch(e){case"patient":return"Ù…Ø±ÙŠØ¶";case"appointment":return"Ù…ÙˆØ¹Ø¯";case"payment":return"Ø¯ÙØ¹Ø©";case"treatment":return"Ø¹Ù„Ø§Ø¬";case"prescription":return"ÙˆØµÙØ©";default:return e}},Q=(t,s,a)=>0===s.length?null:e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 bg-muted/50",children:e.jsxs("h3",{className:"text-sm font-medium text-muted-foreground",children:[t," (",s.length,")"]})}),s.map((t,s)=>((t,s)=>e.jsx("div",{className:"p-3 cursor-pointer border-r-2 transition-colors "+(q===s?"bg-accent border-r-primary":"hover:bg-muted border-r-transparent"),onClick:()=>G(t),children:e.jsxs("div",{className:"flex items-start gap-3",dir:"rtl",children:[L(t.type),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-medium text-sm truncate",children:t.title}),e.jsx(m,{variant:"outline",className:"text-xs",children:M(t.type)})]}),e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:t.subtitle}),t.description&&e.jsx("p",{className:"text-xs text-muted-foreground",children:t.description})]}),e.jsx(g,{className:"w-4 h-4 text-muted-foreground"})]})},t.id))(t,a+s))]});return e.jsxs("div",{ref:B,className:"relative w-full max-w-2xl mx-auto",children:[e.jsxs("div",{className:"relative",children:[e.jsx(a,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(r,{ref:A,value:v,onChange:e=>k(e.target.value),onKeyDown:e=>{if(!w||!D)return;const t=[...w.patients,...w.appointments,...w.payments,...w.treatments,...w.prescriptions];switch(e.key){case"ArrowDown":e.preventDefault(),z(e=>e<t.length-1?e+1:e);break;case"ArrowUp":e.preventDefault(),z(e=>e>0?e-1:-1);break;case"Enter":e.preventDefault(),q>=0&&t[q]&&G(t[q]);break;case"Escape":e.preventDefault(),H()}},placeholder:N,className:"pr-10 pl-10 h-12 text-base",dir:"rtl"}),v&&e.jsx(n,{variant:"ghost",size:"sm",className:"absolute left-2 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0",onClick:H,children:e.jsx(l,{className:"w-4 h-4"})}),b&&e.jsx("div",{className:"absolute left-10 top-1/2 transform -translate-y-1/2",children:e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"})})]}),D&&w&&e.jsx(c,{className:"absolute top-full mt-2 w-full max-h-96 overflow-hidden shadow-lg z-50",children:e.jsx(i,{className:"p-0",children:w.totalCount>0?e.jsxs("div",{ref:F,className:"max-h-96 overflow-y-auto",children:[e.jsx("div",{className:"px-3 py-2 bg-primary/5 border-b",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[w.totalCount," Ù†ØªÙŠØ¬Ø© ÙÙŠ ",w.searchTime,"ms"]}),e.jsxs("span",{className:"text-muted-foreground",children:['"',w.query,'"']})]})}),Q("Ø§Ù„Ù…Ø±Ø¶Ù‰",w.patients,0),w.patients.length>0&&w.appointments.length>0&&e.jsx(o,{}),Q("Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯",w.appointments,w.patients.length),(w.patients.length>0||w.appointments.length>0)&&w.payments.length>0&&e.jsx(o,{}),Q("Ø§Ù„Ø¯ÙØ¹Ø§Øª",w.payments,w.patients.length+w.appointments.length),(w.patients.length>0||w.appointments.length>0||w.payments.length>0)&&w.treatments.length>0&&e.jsx(o,{}),Q("Ø§Ù„Ø¹Ù„Ø§Ø¬Ø§Øª",w.treatments,w.patients.length+w.appointments.length+w.payments.length),(w.patients.length>0||w.appointments.length>0||w.payments.length>0||w.treatments.length>0)&&w.prescriptions.length>0&&e.jsx(o,{}),Q("Ø§Ù„ÙˆØµÙØ§Øª",w.prescriptions,w.patients.length+w.appointments.length+w.payments.length+w.treatments.length)]}):e.jsxs("div",{className:"p-6 text-center text-muted-foreground",children:[e.jsx(a,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsxs("p",{children:['Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù„Ù„Ø¨Ø­Ø« "',v,'"']}),S.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-xs mb-2",children:"Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø£Ø®ÙŠØ±Ø©:"}),e.jsx("div",{className:"flex flex-wrap gap-1 justify-center",children:S.slice(0,5).map((t,s)=>e.jsx(m,{variant:"outline",className:"cursor-pointer text-xs",onClick:()=>k(t),children:t},s))})]})]})})})]})}export{j as default};
